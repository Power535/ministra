"use strict";function elattr(obj,attr){if(obj&&obj.nodeType&&attr&&attr instanceof Object)for(var key in attr)attr.hasOwnProperty(key)&&(obj[key]=attr[key]);return obj}function element(name,attr,data){var tag=document.createElement(name);return elattr(tag,attr),elchild(tag,data),tag}function elchild(obj,value){if(obj&&value)if(value.nodeType)obj.appendChild(value);else if(Array.isArray(value))for(var i=0;i<value.length;i++)elchild(obj,value[i]);else obj.appendChild(document.createTextNode(value));return obj}function elclear(obj){if(null!==obj&&obj.nodeName&&obj.hasChildNodes())for(;obj.hasChildNodes();)obj.removeChild(obj.firstChild);return obj}function loadScript(src,onload,onerror){var elem=document.createElement("script");elem.type="text/javascript",elem.src=src,"function"==typeof onload&&(elem.onload=onload),"function"==typeof onerror&&(elem.onerror=onerror),document.head.appendChild(elem)}function getCurrentLanguage(langList){var langEnv=JSON.parse(gSTB.GetEnv('{"varList":["language"]}')),langVal="en";return langList=langList||["en","ru","uk","de","tr"],!langEnv.errMsg&&langEnv.result&&langEnv.result.language&&"string"==typeof langEnv.result.language&&(langEnv.result.language=langEnv.result.language.toLowerCase(),-1!==langList.indexOf(langEnv.result.language)&&(langVal=langEnv.result.language)),langVal}function getEnvList(list){var data;try{if(data=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:list}))),""!==data.errMsg)throw new Error(data.errMsg);return data.result}catch(e){echo(e)}return!1}function getEnv(name){var data=getEnvList([name]);return data!==!1&&void 0!==data[name]?data[name]:data}function setEnv(key,value){var vars={};return vars[key]=value,setEnvList(vars)}function setEnvList(hash){try{return gSTB.SetEnv(JSON.stringify(hash))}catch(e){echo(e)}return!1}function eventPrepare(event,stopBubble,label){return void 0!==event.code?!0:(event.code=event.keyCode||event.which,0===event.code?!1:(event.shiftKey&&(event.code+=1e3),event.altKey&&(event.code+=2e3),event.code===KEYS.USB_MOUNTED||event.code===KEYS.USB_UNMOUNTED?!1:(stopBubble!==!1&&event.stopPropagation(),echo(event.code+"	"+event.shiftKey+"	"+event.ctrlKey+"	"+event.altKey+"	"+event.srcElement.id+"	"+event.target.id+"	"+(label||""),"keyDown [code/shift/ctrl/alt/src/target]"),!0)))}function ajax(method,url,callback,headers,type,async){var hname,jdata=null,timeout=null,xhr=new XMLHttpRequest,title="AJAX "+method.toUpperCase()+" "+url;if(async=async!==!1,xhr.onreadystatechange=function(){if(4===xhr.readyState)if(clearTimeout(timeout),ajax.stop)echo(xhr.status,title),"function"==typeof callback&&callback(null,null,null);else{if(echo("status:"+xhr.status+", length:"+xhr.responseText.length,title),"json"===type&&200===xhr.status)try{jdata=JSON.parse(xhr.responseText)}catch(e){echo(e,"AJAX JSON.parse"),jdata=null}"function"==typeof callback&&callback("xml"===type?xhr.responseXML:"json"===type?jdata:xhr.responseText,xhr.status,xhr)}},xhr.open(method,url,async),headers)for(hname in headers)headers.hasOwnProperty(hname)&&xhr.setRequestHeader(hname,headers[hname]);return xhr.send(),echo("sent",title),timeout=setTimeout(function(){xhr.abort(),echo("ABORT on timeout",title),"function"==typeof callback&&callback(null,0)},6e4),xhr}function imageLoader(imgList,callback){var count=1,onload=function(){imgList.length===count&&"function"==typeof callback?callback():count++};Array.isArray(imgList)&&imgList.length>0?imgList.forEach(function(item){var img=new Image;img.src=item,img.onload=onload,img.onerror=function(){throw"Image "+item+" load fail"}}):0===imgList.length&&callback()}function getStorageInfo(){var snList={},info=JSON.parse(gSTB.GetStorageInfo("{}"));Array.isArray(info.result)&&""===info.errMsg&&info.result.length>0?(info.result.forEach(function(item){item.mediaType="000022272228"===item.sn?3:item.mediaType,item.label=item.label.trim(),snList[item.sn]?snList[item.sn]++:snList[item.sn]=1}),info.result.forEach(function(item){item.label||(item.label=item.vendor+" "+item.model.replace(/\//,""),snList[item.sn]>1&&(item.label+=" #"+item.partitionNum)),item.isReadOnly&&(item.label+=" ("+_("Read only")+")")}),info.result.sort(function(a,b){return a.mountPath<b.mountPath?-1:1}),window.STORAGE_INFO=info.result):window.STORAGE_INFO=[];try{window.HDD_INFO=JSON.parse(gSTB.RDir("get_hdd_info")||"[]")}catch(e){echo(e,"get_hdd_info"),window.HDD_INFO=[]}echo(STORAGE_INFO,"STORAGE_INFO"),echo(HDD_INFO,"HDD_INFO")}function parseUri(str){for(var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;i--;)uri[o.key[i]]=m[i]||"";return uri[o.q.name]={},uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){$1&&(uri[o.q.name][$1]=$2)}),uri}function validateUrl(url,sol,isSolutionOptional,isProtocolOptional){var solReg="((ffmpeg|auto|rtp|rtsp|mp3|mpegps|mpegts|mp4|ifm|fm|ffrt|ffrt2|ffrt3|ffrt4)(\\s))";return isProtocolOptional=typeof isProtocolOptional==typeof!0?isProtocolOptional:!0,new RegExp("^"+(sol?solReg:"")+["","?"][+!!isSolutionOptional]+"(((http|https|udp|rtp|rtsp|mms|mmsh|mmst|rtmp|igmp):\\/\\/)"+["","?"][+isProtocolOptional]+"@?(([a-zA-Z0-9а-яА-Я$\\-_.+!*'(),;:&=]|%[0-9a-fA-Fа-яА-Я]{2})+@)?(((25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])(\\.(25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])){3})|localhost|([a-zA-Zа-яА-Я0-9\\-\\u00C0-\\u017F]+\\.)+([a-zA-Zа-яА-Я]{2,}))(:[0-9]+)?|((file:///|/)[a-zA-Zа-яА-Я0-9\\-\\u00C0-\\u017F]+))(\\/(([a-zA-Zа-яА-Я0-9$\\-_.+!*'(),;:@&=\\s]|%[0-9a-fA-Fа-яА-Я]{2})*(\\/([a-zA-Zа-яА-Я0-9$\\-_.+!*'(),;:@&=\\s]|%[0-9a-fA-Fа-яА-Я]{2})*)*)?(\\?([a-zA-Zа-яА-Я0-9$\\-_.+!*'(),;:@&=\\/?]|%[0-9a-fA-Fа-яА-Я]{2})*)?(\\#([a-zA-Zа-яА-Я0-9$\\-_.+!*'(),;:@&=\\/?]|%[0-9a-fA-Fа-яА-Я]{2})*)?)?$").test(url)}function extend(target,source,override){var _target=override===!1?extend({},target):target||{};for(var prop in source)"object"!=typeof _target[prop]||"object"!=typeof source[prop]||Array.isArray(_target[prop])||Array.isArray(source[prop])?_target[prop]=source[prop]:_target[prop]=extend(_target[prop],source[prop],override);return _target}function base64Encode(data){return btoa(unescape(encodeURIComponent(data)))}function base64Decode(data){try{return decodeURIComponent(escape(atob(data)))}catch(error){echo(error,"base64Decode Error")}}function cutTextWithEllipsis(text,length){return text.length>length?text.toString().slice(0,length)+"...":text}function parseDate(dateStr){if(!dateStr)return new Date(NaN);var date=new Date(dateStr.match(/\w{3}\s\w{3}\s\d{1,2}\s\d{1,2}:\d{1,2}:\d{1,2}/)+" "+dateStr.match(/\d{4}/)),timeZone=dateStr.match(/(\w{1,4}|((\+|-)\d{1,2}))\s+\d{4}/)[1],offset=timeZoneOffsets[timeZone];return date.setMinutes(date.getMinutes()-date.getTimezoneOffset()),0!==offset.index&&date.setMinutes(date.getMinutes()+(offset.minutes||0)*offset.index),date}function getMediaType(file){var extension=file.split(".").pop().toLowerCase();if(extension&&-1!==configuration.registersTypes.indexOf(extension))for(var type,i=0;i<MEDIA_TYPES.length,type=MEDIA_TYPES[i];i++)if(-1!==MEDIA_EXTENSION[type].indexOf(extension))return type;return MEDIA_TYPE_NONE}function readJSON(path,fileName){var result,xmlhttp=new XMLHttpRequest;path=path+"/"+fileName;try{xmlhttp.open("GET",path,!1),xmlhttp.send(null),result=xmlhttp.responseText}catch(e){echo(e,"some xmlhttp error"),result=""}return echo(result,"file "+path),result}function init(){if(gs.layers.context=document.getElementById("game").getContext("2d"),gs.layers.context&&gs.layers.context.drawImage){var loc=window.location.href;if(loc.indexOf("?")>=0){for(var part,parts=loc.substr(loc.indexOf("?")+1).split("&"),_GET={},key=0;key<parts.length;key++)part=parts[key],_GET[part.substr(0,part.indexOf("="))]=part.substr(part.indexOf("=")+1);pages.referrer=decodeURIComponent(_GET.referrer)}else pages.referrer=document.referrer;echo("\n\npages.referrer: "+pages.referrer+"\nwindow.location: "+window.location+"\n\n"),document.getElementById("game").width=gs.size[WINDOW_HEIGHT].scr.w,document.getElementById("game").height=gs.size[WINDOW_HEIGHT].scr.h,document.getElementById("cursorBox").style.width=gs.size[WINDOW_HEIGHT].scr.w+"px",document.getElementById("cursorBox").style.height=gs.size[WINDOW_HEIGHT].scr.h+"px",window.moveTo(0,0),window.resizeTo(EMULATION?window.outerWidth:screen.width,EMULATION?window.outerHeight:screen.height),gSTB.EnableServiceButton(!0),gs.balls=[];for(var i=0;i<gs.cells.y;i++){gs.balls[i]=[];for(var j=0;j<gs.cells.x;j++)gs.balls[i][j]=null}cvDraw.generateNextBalls(),cvDraw.showBall(),cvDraw.item()}}function random(max){return Math.floor(Math.random()*(parseInt(max,10)+1))}var DEBUG=!0,DEBUG_NAME="",DEBUG_SERVER="",EMULATION=!1,PATH_MODE_WEB=!1,PATH_ROOT=null,PATH_SYSTEM=null,PATH_MEDIA="/media/",WINDOW_WIDTH=screen.width,WINDOW_HEIGHT=screen.height,URL_PARAMS={},initFound=!1,proxy;PATH_ROOT=location.pathname.split("/"),PATH_ROOT[PATH_ROOT.length-1]="",PATH_ROOT=PATH_ROOT.join("/"),PATH_ROOT=location.protocol+"//"+location.host+PATH_ROOT+PATH_BASE,PATH_SYSTEM=PATH_ROOT+"system/",document.location.search&&document.location.search.substring(1).split("&").forEach(function(part){part=part.split("="),2===part.length&&(URL_PARAMS[part[0]]=decodeURIComponent(part[1]))}),void 0===window.gSTB?(DEBUG=EMULATION=!0,DEBUG_SERVER=DEBUG_SERVER||localStorage.getItem("DEBUG_SERVER"),DEBUG_NAME=DEBUG_NAME||localStorage.getItem("DEBUG_NAME"),WINDOW_WIDTH=parseInt(URL_PARAMS.width,10)||window.outerWidth,WINDOW_HEIGHT=parseInt(URL_PARAMS.height,10)||window.outerHeight,document.write('<script type="text/javascript" src="'+PATH_SYSTEM+'gstb.js"></script>\n'),document.write('<script type="text/javascript" src="'+PATH_SYSTEM+'debug.js"></script>\n'),document.write('<script type="text/javascript" src="http://'+DEBUG_SERVER+':8800/file/client.js"></script>\n'),document.write('<script type="text/javascript">if ( window.proxyClient ) {proxy = new proxyClient();if ( DEBUG_NAME && DEBUG_SERVER ) proxy.init({name:"'+DEBUG_NAME+'", host:"'+DEBUG_SERVER+'"}); }</script>\n'),window.addEventListener("load",function(){document.body.style.backgroundColor="black"})):(gSTB.SetNativeStringMode(!0),function(){var vars=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["debug","debug_name","debug_server"]})));!vars.errMsg&&vars.result&&(DEBUG="1"===vars.result.debug,DEBUG&&!URL_PARAMS.nodebug&&(document.write('<script type="text/javascript" src="'+PATH_SYSTEM+'debug.js"></script>\n'),DEBUG_NAME=DEBUG_NAME||vars.result.debug_name,DEBUG_SERVER=DEBUG_SERVER||vars.result.debug_server,DEBUG_NAME&&DEBUG_SERVER&&"1"!==stbStorage.getItem("spyjs.active")&&document.write('<script type="text/javascript" src="http://'+DEBUG_SERVER+":8000/target/target-script-min.js#"+DEBUG_NAME+'"></script>\n')))}());var PATH_IMG_SYSTEM=PATH_SYSTEM+"img/"+WINDOW_WIDTH+"/",PATH_IMG_PUBLIC=PATH_ROOT+"public/img/"+WINDOW_WIDTH+"/",KEYS={BACK:8,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,NUM9:57,NUM0:48,DELETE:46,CHANNEL_PREV:1009,CHANNEL_NEXT:9,OK:13,EXIT:27,UP:38,DOWN:40,LEFT:37,RIGHT:39,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,VOLUME_UP:107,VOLUME_DOWN:109,F1:112,F2:113,F3:114,F4:115,REFRESH:116,FRAME:117,PHONE:119,EPG:119,SET:120,TV:121,MENU:122,WEB:123,MIC:2032,REWIND:2066,FORWARD:2070,APP:2076,USB_MOUNTED:2080,USB_UNMOUNTED:2081,PLAY_PAUSE:2082,STOP:2083,POWER:2085,RECORD:2087,INFO:2089,MUTE:2192,CLOCK:2032,AUDIO:2071,KEYBOARD:2076};if(void 0===window.echo&&(window.echo=function(data,title){}),ajax.stop=!1,parseUri.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},!("classList"in document.documentElement)){var prototype=Array.prototype,indexOf=prototype.indexOf,slice=prototype.slice,push=prototype.push,splice=prototype.splice,join=prototype.join;window.DOMTokenList=function(el){if(this._element=el,el.className!==this._classCache){if(this._classCache=el.className,!this._classCache)return;var i,classes=this._classCache.replace(/^\s+|\s+$/g,"").split(/\s+/);for(i=0;i<classes.length;i++)push.call(this,classes[i])}},window.DOMTokenList.prototype={add:function(token){this.contains(token)||(push.call(this,token),this._element.className=slice.call(this,0).join(" "))},contains:function(token){return-1!==indexOf.call(this,token)},item:function(index){return this[index]||null},remove:function(token){var i=indexOf.call(this,token);-1!==i&&(splice.call(this,i,1),this._element.className=slice.call(this,0).join(" "))},toString:function(){return join.call(this," ")},toggle:function(token){return this.contains(token)?this.remove(token):this.add(token),this.contains(token)}},Object.defineProperty(Element.prototype,"classList",{get:function(){return new window.DOMTokenList(this)}})}var Events={bind:function(event,callback){if(this._events||(this._events={}),"object"==typeof event)for(var name in event)this.bind(name,event[name]);else"string"==typeof event&&"function"==typeof callback&&(void 0===this._events[event]&&(this._events[event]=[]),this._events[event].push(callback))},trigger:function(event,data){var result,results=[],self=this;return void 0!==event&&void 0!==this._events&&void 0!==this._events[event]&&this._events[event].forEach(function(ev){result=ev.call(self,data),void 0!==result&&results.push(result)}),results},unbind:function(event){delete this._events[event]},inject:function(obj){"function"==typeof obj?extend(obj.prototype,this):"object"==typeof obj&&extend(obj,this)}},timeZoneOffsets={A:{index:-1,minutes:60},ACDT:{index:-1,minutes:60},ACST:{index:-1,minutes:570},ACT:{index:1,minutes:300},ACWST:{index:-1,minutes:525},ADT:{index:1,minutes:180},AEDT:{index:-1,minutes:61},AEST:{index:-1,minutes:60},AFT:{index:-1,minutes:270},AKDT:{index:1,minutes:480},AKST:{index:1,minutes:540},ALMT:{index:-1,minutes:360},AMST:{index:1,minutes:180},AMT:{index:1,minutes:240},ANAST:{index:-1,minutes:62},ANAT:{index:-1,minutes:62},AQTT:{index:-1,minutes:300},ART:{index:1,minutes:180},AST:{index:1,minutes:240},AWDT:{index:-1,minutes:540},AWST:{index:-1,minutes:480},AZOST:{index:0,minutes:0},AZOT:{index:1,minutes:60},AZST:{index:-1,minutes:300},AZT:{index:-1,minutes:240},B:{index:-1,minutes:120},BNT:{index:-1,minutes:480},BOT:{index:1,minutes:240},BRST:{index:1,minutes:120},BRT:{index:1,minutes:180},BST:{index:-1,minutes:60},BTT:{index:-1,minutes:360},C:{index:-1,minutes:180},CAST:{index:-1,minutes:480},CAT:{index:-1,minutes:120},CCT:{index:-1,minutes:390},CDT:{index:1,minutes:300},CEST:{index:-1,minutes:120},CET:{index:-1,minutes:60},CHADT:{index:-1,minutes:63},CHAST:{index:-1,minutes:62},CHOT:{index:-1,minutes:480},CHUT:{index:-1,minutes:600},CKT:{index:1,minutes:60},CLST:{index:1,minutes:180},CLT:{index:1,minutes:240},COT:{index:1,minutes:300},CST:{index:1,minutes:360},CVT:{index:1,minutes:60},CXT:{index:-1,minutes:420},ChST:{index:-1,minutes:60},D:{index:-1,minutes:240},DAVT:{index:-1,minutes:420},E:{index:-1,minutes:300},EASST:{index:1,minutes:300},EAST:{index:1,minutes:360},EAT:{index:-1,minutes:180},ECT:{index:1,minutes:300},EDT:{index:-1,minutes:61},EEST:{index:-1,minutes:180},EET:{index:-1,minutes:120},EGST:{index:0,minutes:0},EGT:{index:1,minutes:60},EST:{index:1,minutes:300},ET:{index:1,minutes:300},F:{index:-1,minutes:360},FET:{index:-1,minutes:180},FJST:{index:-1,minutes:63},FJT:{index:-1,minutes:62},FKST:{index:1,minutes:180},FKT:{index:1,minutes:240},FNT:{index:1,minutes:120},G:{index:-1,minutes:420},GALT:{index:1,minutes:360},GAMT:{index:1,minutes:540},GET:{index:-1,minutes:240},GFT:{index:1,minutes:180},GILT:{index:-1,minutes:62},GMT:{index:0,minutes:0},GST:{index:-1,minutes:240},GYT:{index:1,minutes:240},H:{index:-1,minutes:480},HAA:{index:1,minutes:180},HAC:{index:1,minutes:300},HADT:{index:1,minutes:540},HAE:{index:1,minutes:240},HAP:{index:1,minutes:420},HAR:{index:1,minutes:360},HAST:{index:1,minutes:60},HAT:{index:1,minutes:150},HAY:{index:1,minutes:480},HKT:{index:-1,minutes:480},HLV:{index:1,minutes:270},HNA:{index:1,minutes:240},HNC:{index:1,minutes:360},HNE:{index:1,minutes:300},HNP:{index:1,minutes:480},HNR:{index:1,minutes:420},HNT:{index:1,minutes:210},HNY:{index:1,minutes:540},HOVT:{index:-1,minutes:420},I:{index:-1,minutes:540},ICT:{index:-1,minutes:420},IDT:{index:-1,minutes:180},IOT:{index:-1,minutes:360},IRDT:{index:-1,minutes:270},IRKST:{index:-1,minutes:540},IRKT:{index:-1,minutes:540},IRST:{index:-1,minutes:210},IST:{index:-1,minutes:60},JST:{index:-1,minutes:540},K:{index:-1,minutes:60},KGT:{index:-1,minutes:360},KOST:{index:-1,minutes:660},KRAST:{index:-1,minutes:480},KRAT:{index:-1,minutes:480},KST:{index:-1,minutes:540},KUYT:{index:-1,minutes:240},L:{index:-1,minutes:61},LHDT:{index:-1,minutes:61},LHST:{index:-1,minutes:60},LINT:{index:-1,minutes:64},M:{index:-1,minutes:62},MAGST:{index:-1,minutes:62},MAGT:{index:-1,minutes:62},MART:{index:1,minutes:570},MAWT:{index:-1,minutes:300},MDT:{index:1,minutes:360},MESZ:{index:-1,minutes:120},MEZ:{index:-1,minutes:60},MHT:{index:-1,minutes:62},MMT:{index:-1,minutes:390},MSD:{index:-1,minutes:240},MSK:{index:-1,minutes:240},MST:{index:1,minutes:420},MUT:{index:-1,minutes:240},MVT:{index:-1,minutes:300},MYT:{index:-1,minutes:480},N:{index:1,minutes:60},NCT:{index:-1,minutes:61},NDT:{index:1,minutes:150},NFT:{index:-1,minutes:61},NOVST:{index:-1,minutes:420},NOVT:{index:-1,minutes:360},NPT:{index:-1,minutes:345},NRT:{index:-1,minutes:720},NST:{index:1,minutes:210},NUT:{index:1,minutes:61},NZDT:{index:-1,minutes:63},NZST:{index:-1,minutes:62},O:{index:1,minutes:120},OMSST:{index:-1,minutes:420},OMST:{index:-1,minutes:420},ORAT:{index:-1,minutes:300},P:{index:1,minutes:180},PDT:{index:1,minutes:420},PET:{index:1,minutes:300},PETST:{index:-1,minutes:62},PETT:{index:-1,minutes:62},PGT:{index:-1,minutes:60},PHOT:{index:-1,minutes:63},PHT:{index:-1,minutes:480},PKT:{index:-1,minutes:300},PMDT:{index:1,minutes:120},PMST:{index:1,minutes:180},PONT:{index:-1,minutes:61},PST:{index:1,minutes:480},PT:{index:1,minutes:480},PWT:{index:-1,minutes:540},PYST:{index:1,minutes:180},PYT:{index:1,minutes:240},Q:{index:1,minutes:240},QYZT:{index:1,minutes:360},R:{index:1,minutes:300},RET:{index:-1,minutes:240},S:{index:1,minutes:360},SAKT:{index:1,minutes:600},SAMT:{index:-1,minutes:240},SAST:{index:-1,minutes:120},SBT:{index:-1,minutes:61},SCT:{index:-1,minutes:240},SGT:{index:-1,minutes:480},SRET:{index:-1,minutes:660},SRT:{index:1,minutes:180},SST:{index:1,minutes:61},T:{index:1,minutes:420},TAHT:{index:1,minutes:60},TFT:{index:-1,minutes:300},TJT:{index:-1,minutes:300},TKT:{index:-1,minutes:63},TLT:{index:-1,minutes:540},TMT:{index:-1,minutes:300},TOT:{index:-1,minutes:780},TVT:{index:-1,minutes:62},U:{index:1,minutes:480},ULAT:{index:-1,minutes:480},UTC:{index:0,minutes:0},UYST:{index:1,minutes:120},UYT:{index:1,minutes:180},UZT:{index:-1,minutes:300},V:{index:1,minutes:540},VET:{index:1,minutes:270},VLAST:{index:-1,minutes:61},VLAT:{index:-1,minutes:61},VUT:{index:-1,minutes:61},W:{index:1,minutes:60},WARST:{index:1,minutes:180},WAST:{index:-1,minutes:120},WAT:{index:-1,minutes:60},WEST:{index:-1,minutes:60},WESZ:{index:-1,minutes:60},WET:{index:0,minutes:0},WEZ:{index:0,minutes:0},WFT:{index:-1,minutes:62},WGST:{index:1,minutes:120},WGT:{index:1,minutes:180},WIB:{index:-1,minutes:420},WIT:{index:-1,minutes:540},WITA:{index:-1,minutes:480},WST:{index:-1,minutes:63},WT:{index:0,minutes:0},X:{index:1,minutes:61},Y:{index:1,minutes:62},YAKST:{index:-1,minutes:60},YAKT:{index:-1,minutes:60},YAPT:{index:-1,minutes:60},YEKST:{index:-1,minutes:360},YEKT:{index:-1,minutes:360},Z:{index:0,minutes:0},"-12":{index:-1,minutes:720},"-11":{index:-1,minutes:660},"-10":{index:-1,minutes:600},"-09":{index:-1,minutes:540},"-08":{index:-1,minutes:480},"-07":{index:-1,minutes:420},"-06":{index:-1,minutes:360},"-05":{index:-1,minutes:300},"-04":{index:-1,minutes:240},"-03":{index:-1,minutes:180},"-02":{index:-1,minutes:120},"-01":{index:-1,minutes:60},"+01":{index:1,minutes:60},"+02":{index:1,minutes:120},"+03":{index:1,minutes:180},"+04":{index:1,minutes:240},"+05":{index:1,minutes:300},"+06":{index:1,minutes:360},"+07":{index:1,minutes:420},"+08":{index:1,minutes:480},"+09":{index:1,minutes:540},"+10":{index:1,minutes:600},"+11":{index:1,minutes:660},"+12":{index:1,minutes:720}};Array.prototype.shuffle=function(){for(var i,tmp,n=this.length;n--;)i=Math.floor(n*Math.random()),tmp=this[i],this[i]=this[n],this[n]=tmp;return this};var version="1.0.2",pages={back:PATH_ROOT+"services.html",referrer:""},keysBlock=!1,gs={account:0,layers:{bg:null,context:null,pointer:null},size:{480:{scr:{w:360,h:360},cll:{w:40,h:40}},576:{scr:{w:450,h:450},cll:{w:50,h:50}},720:{scr:{w:495,h:495},cll:{w:55,h:55}},1080:{scr:{w:765,h:765},cll:{w:85,h:85}}},cells:{x:9,y:9},position:{old:{x:0,y:0},current:{x:0,y:0}},move:{selected:!1,readyToCheck:!1,start:{x:-1,y:-1},finish:{x:-1,y:-1}},coeff:1,balls:null,colors:["red","blue","green","orange","violet","black","white"],nextBalls:[]},key={press:function(event){if(eventPrepare(event,!1))switch(event.code){case KEYS.RIGHT:gs.position.old.y=gs.position.current.y,gs.position.old.x=gs.position.current.x,gs.position.current.x+1<=gs.cells.x-1?gs.position.current.x++:gs.position.current.x=gs.cells.x-1,cvDraw.item();break;case KEYS.LEFT:gs.position.old.y=gs.position.current.y,gs.position.old.x=gs.position.current.x,gs.position.current.x-1>=0?gs.position.current.x--:gs.position.current.x=0,cvDraw.item();break;case KEYS.DOWN:gs.position.old.y=gs.position.current.y,gs.position.old.x=gs.position.current.x,gs.position.current.y+1<=gs.cells.y-1?gs.position.current.y++:gs.position.current.y=gs.cells.y-1,cvDraw.item();break;case KEYS.UP:gs.position.old.y=gs.position.current.y,gs.position.old.x=gs.position.current.x,gs.position.current.y-1>=0?gs.position.current.y--:gs.position.current.y=0,cvDraw.item();break;case KEYS.OK:if(1==keysBlock)return void(window.location=window.location.href.substr(0,window.location.href.indexOf("?"))+"?referrer="+encodeURIComponent(pages.referrer));cvDraw.PressOK();break;case KEYS.NUM1:cvDraw.jumpBallStop();break;case KEYS.F1:echo(cvDraw.showArr());break;case KEYS.NUM9:case KEYS.RECORD:cvDraw.showBall();break;case KEYS.REFRESH:window.location=window.location.href.substr(0,window.location.href.indexOf("?"))+"?referrer="+encodeURIComponent(pages.referrer);break;case KEYS.EXIT:document.body.style.display="none",document.body.parentElement.style.background="none",pages.referrer.length>4?window.location=pages.referrer:window.location=pages.back;break;case KEYS.POWER:var standByMode,standByStatus=!gSTB.GetStandByStatus(),environment=gSTB.GetEnv(JSON.stringify({varList:["standByMode"]}));try{environment=JSON.parse(environment).result}catch(e){environment={standByMode:null}}if(standByMode=parseInt(environment.standByMode,10),gSTB.StandByMode!==standByMode&&(gSTB.StandByMode=standByMode),3===standByMode)return gSTB.SetLedIndicatorMode(2),gSTB.StandBy(standByStatus),void gSTB.SetLedIndicatorMode(1);standByStatus?(document.body.style.display="none",gSTB.StandBy(standByStatus),gSTB.SetLedIndicatorMode(2),window.location=""):(gSTB.StandBy(standByStatus),gSTB.SetLedIndicatorMode(1))}}};window.onload=init,window.onkeydown=key.press,window.oncontextmenu=EMULATION?null:function(){return!1};var cvDraw={sizeScr:"",ball:null,bgImg_1:"",bgImg_2:"",stopAddBalls:!1,isEndGame:!1,item:function(){document.getElementById("cursor").style.marginLeft=gs.position.current.x*gs.size[WINDOW_HEIGHT].cll.w+"px",document.getElementById("cursor").style.marginTop=gs.position.current.y*gs.size[WINDOW_HEIGHT].cll.h+"px"},createBall:function(n_color,n_x,n_y){var ball=new Image,clolor=n_color?n_color:gs.colors[random(gs.colors.length-1)],self=this;ball.src=PATH_IMG_PUBLIC+"games/lines/"+clolor+".png",ball.addEventListener("load",function(){var coords=self.findeFreePlace(),x=n_color&&-1!=n_x?n_x:coords[0],y=n_color&&-1!=n_y?n_y:coords[1];if(0==coords)return void cvDraw.showfinish();var img=this;gs.balls[y][x]={x:x,y:y,color:clolor,scale:.1,img:img,siObj:null,_f:function(x,y){this.scale<1?(this.scale+=.2,gs.layers.context.globalCompositeOperation="source-over",gs.layers.context.drawImage(this.img,x*gs.size[WINDOW_HEIGHT].cll.w+gs.size[WINDOW_HEIGHT].cll.w/2-gs.size[WINDOW_HEIGHT].cll.w*gs.balls[y][x].scale/2,y*gs.size[WINDOW_HEIGHT].cll.h+gs.size[WINDOW_HEIGHT].cll.h/2-gs.size[WINDOW_HEIGHT].cll.h*gs.balls[y][x].scale/2,gs.size[WINDOW_HEIGHT].cll.w*this.scale,gs.size[WINDOW_HEIGHT].cll.h*this.scale)):(clearInterval(this.siObj),this.siObj=null)}},gs.balls[y][x].scale=.4,gs.layers.context.drawImage(this,x*gs.size[WINDOW_HEIGHT].cll.w+gs.size[WINDOW_HEIGHT].cll.w/2-gs.size[WINDOW_HEIGHT].cll.w*gs.balls[y][x].scale/2,y*gs.size[WINDOW_HEIGHT].cll.h+gs.size[WINDOW_HEIGHT].cll.h/2-gs.size[WINDOW_HEIGHT].cll.h*gs.balls[y][x].scale/2,gs.size[WINDOW_HEIGHT].cll.w*gs.balls[y][x].scale,gs.size[WINDOW_HEIGHT].cll.h*gs.balls[y][x].scale),gs.balls[y][x].siObj=setInterval(function(){gs.balls[y][x]._f(x,y)},25)},!1)},showfinish:function(){keysBlock=!0,gs.account<50?document.getElementById("errorFinish").style.display="block":document.getElementById("errorFinish2").style.display="block"},showBall:function(){if(0==this.isEndGame){for(var i=0;i<gs.nextBalls.length;i++)this.createBall(gs.nextBalls[i],-1,-1);for(var counter=0,i=0;i<gs.balls.length;i++)for(var j=0;j<gs.balls[i].length;j++)null!=gs.balls[i][j]&&counter++;if(counter+3>=gs.balls.length*gs.balls[0].length)return void this.showfinish();this.generateNextBalls();var self=this;setTimeout(function(){self.checkLines(!1)},250)}else this.stopAddBalls=!1},jumpBallTimer:null,jumpBallScale:.6,jumpBallScaleD:.1,jumpBall:function(v){var self=this;9==v&&(this.jumpBallTimer=setInterval(function(){self.jumpBallStartJumping()},60))},jumpBallStartJumping:function(){this.jumpBallScale>=.75&&(this.jumpBallScaleD=-.05),this.jumpBallScale<=.55&&(this.jumpBallScaleD=.05),this.jumpBallScale+=this.jumpBallScaleD,gs.layers.context.clearRect(gs.move.start.x*gs.size[WINDOW_HEIGHT].cll.w,gs.move.start.y*gs.size[WINDOW_HEIGHT].cll.h,gs.size[WINDOW_HEIGHT].cll.w,gs.size[WINDOW_HEIGHT].cll.h),gs.layers.context.drawImage(gs.balls[gs.move.start.y][gs.move.start.x].img,gs.move.start.x*gs.size[WINDOW_HEIGHT].cll.w,gs.move.start.y*gs.size[WINDOW_HEIGHT].cll.h+gs.size[WINDOW_HEIGHT].cll.h/3-gs.size[WINDOW_HEIGHT].cll.h*this.jumpBallScale/2,gs.size[WINDOW_HEIGHT].cll.w,gs.size[WINDOW_HEIGHT].cll.h)},findeFreePlace:function(){try{var x=random(gs.cells.x-1),y=random(gs.cells.y-1);return null!=gs.balls[y][x]?this.findeFreePlace():[x,y]}catch(e){return this.isEndGame=!0,this.showfinish(),!1}},jumpBallStop:function(){clearInterval(this.jumpBallTimer),gs.move.selected=!1},ballMoveStart:function(){if(null!=gs.balls[gs.position.current.y][gs.position.current.x]){gs.move.readyToCheck=!1,gs.move.selected=!0,gs.move.start.x=gs.position.current.x,gs.move.start.y=gs.position.current.y;var self=this;this.jumpBallTimer=setInterval(function(){self.jumpBallStartJumping()},60)}},PressOK:function(){1==gs.move.selected?gs.move.start.x==gs.position.current.x&&gs.move.start.y==gs.position.current.y?(cvDraw.jumpBallStop(),gs.move.start.x=-1,gs.move.start.y=-1,echo("disable select")):(null!=gs.balls[gs.position.current.y][gs.position.current.x]&&(cvDraw.jumpBallStop(),gs.move.readyToCheck=!1,gs.move.selected=!0,gs.move.start.x=gs.position.current.x,gs.move.start.y=gs.position.current.y,this.ballMoveStart(),echo("enable select")),gs.move.finish.x=gs.position.current.x,gs.move.finish.y=gs.position.current.y,this.checkWay()):-1==gs.move.start.x&&-1==gs.move.start.y&&null!=gs.balls[gs.position.current.y][gs.position.current.x]&&(gs.move.readyToCheck=!1,gs.move.selected=!0,gs.move.start.x=gs.position.current.x,gs.move.start.y=gs.position.current.y,this.ballMoveStart(),echo("enable select"))},arr:[],checkWay:function(){if(null==gs.balls[gs.move.finish.y][gs.move.finish.x]){this.currentNum=0,this.arr=[];for(var i=0;i<gs.cells.y;i++){this.arr[i]=[];for(var j=0;j<gs.cells.x;j++)null!=gs.balls[i][j]?this.arr[i][j]="#":this.arr[i][j]="_"}this.arr[gs.move.start.y][gs.move.start.x]="S",this.arr[gs.move.finish.y][gs.move.finish.x]="F";var way=this.findPath(gs.move.start.x,gs.move.start.y);0!=way?this.drawWay(way):(document.getElementById("errorBadPath").style.display="block",setTimeout(function(){document.getElementById("errorBadPath").style.display="none"},1500))}},showArr:function(){for(var str="\n",i=0;i<gs.cells.x;i++){for(var line="",j=0;j<gs.cells.x;j++)line+=this.arr[i][j]+" ";str+=line+"\n"}return str},currentNum:0,findPath:function(x,y){if(0>x||x>this.arr.length-1||0>y||y>this.arr[0].length-1)return!1;if("F"==this.arr[y][x])return!0;if("_"!=this.arr[y][x]&&"S"!=this.arr[y][x])return!1;this.arr[y][x]=this.currentNum++;for(var k=0;k<this.arr.length*this.arr[0].length;k++)for(var i=0;i<this.arr.length;i++)for(var j=0;j<this.arr[i].length;j++)this.arr[i][j]==k&&this.setNums(j,i,k+1);return this.getWay()},setNums:function(x,y,num){0>x||x>this.arr.length-1||0>y-1||y-1>this.arr[0].length-1||"_"!=this.arr[y-1][x]||(this.arr[y-1][x]=num),0>x||x>this.arr.length-1||0>y+1||y+1>this.arr[0].length-1||"_"!=this.arr[y+1][x]||(this.arr[y+1][x]=num),0>x-1||x-1>this.arr.length-1||0>y||y>this.arr[0].length-1||"_"!=this.arr[y][x-1]||(this.arr[y][x-1]=num),0>x+1||x+1>this.arr.length-1||0>y||y>this.arr[0].length-1||"_"!=this.arr[y][x+1]||(this.arr[y][x+1]=num)},getMinFrom:function(x,y){var tmp=[],tmp_obj=[];0>x||x>this.arr.length-1||0>y-1||y-1>this.arr[0].length-1||"_"==this.arr[y-1][x]||"#"==this.arr[y-1][x]||(tmp[tmp.length]=this.arr[y-1][x],tmp_obj[tmp_obj.length]={x:x,y:y-1}),0>x||x>this.arr.length-1||0>y+1||y+1>this.arr[0].length-1||"_"==this.arr[y+1][x]||"#"==this.arr[y+1][x]||(tmp[tmp.length]=this.arr[y+1][x],tmp_obj[tmp_obj.length]={x:x,y:y+1}),0>x-1||x-1>this.arr.length-1||0>y||y>this.arr[0].length-1||"_"==this.arr[y][x-1]||"#"==this.arr[y][x-1]||(tmp[tmp.length]=this.arr[y][x-1],tmp_obj[tmp_obj.length]={x:x-1,y:y}),0>x+1||x+1>this.arr.length-1||0>y||y>this.arr[0].length-1||"_"==this.arr[y][x+1]||"#"==this.arr[y][x+1]||(tmp[tmp.length]=this.arr[y][x+1],tmp_obj[tmp_obj.length]={x:x+1,y:y});for(var minValue=999,minIndex=0,i=0;i<tmp.length;i++)minValue>tmp[i]&&(minValue=tmp[i],minIndex=i);return tmp_obj?{obj:tmp_obj[minIndex],num:tmp[minIndex]}:!1},getMinAtThe:function(x,y,num){var tmp=[],tmp_obj=[];return 0>x||x>this.arr.length-1||0>y-1||y-1>this.arr[0].length-1||this.arr[y-1][x]!=num||(tmp_obj[tmp_obj.length]={x:x,y:y-1}),0>x||x>this.arr.length-1||0>y+1||y+1>this.arr[0].length-1||this.arr[y+1][x]!=num||(tmp[tmp.length]=this.arr[y+1][x],tmp_obj[tmp_obj.length]={x:x,y:y+1}),0>x-1||x-1>this.arr.length-1||0>y||y>this.arr[0].length-1||this.arr[y][x-1]!=num||(tmp[tmp.length]=this.arr[y][x-1],tmp_obj[tmp_obj.length]={x:x-1,y:y}),0>x+1||x+1>this.arr.length-1||0>y||y>this.arr[0].length-1||this.arr[y][x+1]!=num||(tmp[tmp.length]=this.arr[y][x+1],tmp_obj[tmp_obj.length]={x:x+1,y:y}),tmp_obj[0]},getWay:function(){var start=this.getMinFrom(gs.move.finish.x,gs.move.finish.y);if(0==start)return!1;for(var curNum=start.num,coords=[start.obj],i=0;i<this.arr.length*this.arr[0].length;i++){try{coords.unshift(this.getMinAtThe(coords[0].x,coords[0].y,--curNum))}catch(e){}try{if(coords[0].x==gs.move.start.x&&coords[0].y==gs.move.start.y)break}catch(e){}}return coords.shift(),coords},drawWay:function(way){1==way.length&&gs.move.start.x==way[0].x&&gs.move.start.y==way[0].y&&(way=[]);for(var i=0;i<way.length;i++)gs.layers.context.drawImage(gs.balls[gs.move.start.y][gs.move.start.x].img,way[i].x*gs.size[WINDOW_HEIGHT].cll.w+gs.size[WINDOW_HEIGHT].cll.w/2-.4*gs.size[WINDOW_HEIGHT].cll.w/2,way[i].y*gs.size[WINDOW_HEIGHT].cll.h+gs.size[WINDOW_HEIGHT].cll.h/2-.4*gs.size[WINDOW_HEIGHT].cll.h/2,.4*gs.size[WINDOW_HEIGHT].cll.w,.4*gs.size[WINDOW_HEIGHT].cll.h);
this.createBall(gs.balls[gs.move.start.y][gs.move.start.x].color,gs.move.finish.x,gs.move.finish.y);var self=this;setTimeout(function(){gs.layers.context.clearRect(gs.move.start.x*gs.size[WINDOW_HEIGHT].cll.w,gs.move.start.y*gs.size[WINDOW_HEIGHT].cll.h,gs.size[WINDOW_HEIGHT].cll.w,gs.size[WINDOW_HEIGHT].cll.h),gs.balls[gs.move.start.y][gs.move.start.x]=null;for(var i=0;i<way.length;i++)gs.layers.context.clearRect(way[i].x*gs.size[WINDOW_HEIGHT].cll.w,way[i].y*gs.size[WINDOW_HEIGHT].cll.h,gs.size[WINDOW_HEIGHT].cll.w,gs.size[WINDOW_HEIGHT].cll.h);gs.move.start.x=-1,gs.move.start.y=-1,gs.move.finish.x=-1,gs.move.finish.y=-1,self.checkLines(!0),self.jumpBallStop()},500)},checkLines:function(setballs){for(var isLineClear=!1,lines=[],y=0;y<gs.balls.length;y++){lines[y]=[];for(var x=0;x<gs.balls[0].length;x++)0==lines[y].length&&null!=gs.balls[y][x]?lines[y][lines[y].length]={color:gs.balls[y][x].color,x:gs.balls[y][x].x,y:gs.balls[y][x].y,del:!1}:null!=gs.balls[y][x]&&lines[y][lines[y].length-1].color==gs.balls[y][x].color?lines[y][lines[y].length]={color:gs.balls[y][x].color,x:gs.balls[y][x].x,y:gs.balls[y][x].y}:lines[y].length<5&&(lines[y]=null!=gs.balls[y][x]?new Array({color:gs.balls[y][x].color,x:gs.balls[y][x].x,y:gs.balls[y][x].y}):[]);if(lines[y].length>=5){echo("\n\n\n\n");for(var new_line=[],start_x=lines[y][0].x,oo=0;oo<lines[y].length;oo++){if(echo("lines["+y+"]["+oo+"].x: "+lines[y][oo].x.toString()+"  -|-  start_x: "+start_x),lines[y][oo].x==start_x||lines[y][oo].x-1==start_x)new_line.push(lines[y][oo]),echo(new_line[new_line.length-1].y+" --- x: "+new_line[new_line.length-1].x);else{if(echo("break, new_line.length: "+new_line.length),!(new_line.length<5))break;new_line=[]}start_x=lines[y][oo].x}lines[y]=new_line,echo("\n\n\n\n")}}for(var i=0;i<lines.length;i++)if(lines[i].length<5)lines[i]=[];else{for(var j=0;j<lines[i].length;j++)null==gs.balls[lines[i][j].y][lines[i][j].x]&&(lines[i]=[]);if(lines[i].length<5)break;for(var j=0;j<lines[i].length;j++)echo("horizontal lines || y: "+lines[i][j].y+" --- x: "+lines[i][j].x),gs.balls[lines[i][j].y][lines[i][j].x]=null,gs.layers.context.clearRect(lines[i][j].x*gs.size[WINDOW_HEIGHT].cll.w,lines[i][j].y*gs.size[WINDOW_HEIGHT].cll.h,gs.size[WINDOW_HEIGHT].cll.w,gs.size[WINDOW_HEIGHT].cll.h);gs.account+=lines[i].length*gs.coeff,isLineClear=!0}lines=[];for(var x=0;x<gs.balls[0].length;x++){lines[x]=[];for(var y=0;y<gs.balls.length;y++)0==lines[x].length&&null!=gs.balls[y][x]?lines[x][lines[x].length]={color:gs.balls[y][x].color,x:gs.balls[y][x].x,y:gs.balls[y][x].y}:null!=gs.balls[y][x]&&lines[x][lines[x].length-1].color==gs.balls[y][x].color?lines[x][lines[x].length]={color:gs.balls[y][x].color,x:gs.balls[y][x].x,y:gs.balls[y][x].y}:lines[x].length<5&&(lines[x]=null!=gs.balls[y][x]?new Array({color:gs.balls[y][x].color,x:gs.balls[y][x].x,y:gs.balls[y][x].y}):[]);if(lines[x].length>=5){echo("\n\n\n\n");for(var new_line=[],start_y=0|lines[x][0].y,oo=0;oo<lines[x].length;oo++){if(echo("lines["+x+"]["+oo+"].y: "+lines[x][oo].y.toString()+"  -|-  start_y "+start_y),lines[x][oo].y==start_y||lines[x][oo].y-1==start_y)new_line.push(lines[x][oo]),echo(new_line[new_line.length-1].y+" --- x: "+new_line[new_line.length-1].x);else{if(echo("break, new_line.length: "+new_line.length),!(new_line.length<5))break;new_line=[]}start_y=lines[x][oo].y}lines[x]=new_line,echo("\n\n\n\n")}}for(var i=0;i<lines.length;i++)if(lines[i].length<5)lines[i]=[];else{for(var j=0;j<lines[i].length;j++)null==gs.balls[lines[i][j].y][lines[i][j].x]&&(lines[i]=[]);if(lines[i].length<5)break;for(var j=0;j<lines[i].length;j++)echo("vertical lines || y: "+lines[i][j].y+" --- x: "+lines[i][j].x),gs.balls[lines[i][j].y][lines[i][j].x]=null,gs.layers.context.clearRect(lines[i][j].x*gs.size[WINDOW_HEIGHT].cll.w,lines[i][j].y*gs.size[WINDOW_HEIGHT].cll.h,gs.size[WINDOW_HEIGHT].cll.w,gs.size[WINDOW_HEIGHT].cll.h);gs.account+=lines[i].length*gs.coeff,isLineClear=!0}var counter=0;lines=[];for(var x=0;x<gs.balls[0].length;x++){var y=0;lines[counter]=[];for(var d=0;d<gs.balls.length;d++)if(x+d<gs.balls[0].length&&y+d<gs.balls.length)if(0==lines[counter].length&&null!=gs.balls[y+d][x+d])lines[counter][lines[counter].length]={color:gs.balls[y+d][x+d].color,x:gs.balls[y+d][x+d].x,y:gs.balls[y+d][x+d].y};else if(null!=gs.balls[y+d][x+d]&&lines[counter][lines[counter].length-1].color==gs.balls[y+d][x+d].color)lines[counter][lines[counter].length]={color:gs.balls[y+d][x+d].color,x:gs.balls[y+d][x+d].x,y:gs.balls[y+d][x+d].y};else{if(!(lines[counter].length<5))continue;null==gs.balls[y+d][x+d]?lines[counter]=[]:lines[counter]=new Array({color:gs.balls[y+d][x+d].color,x:gs.balls[y+d][x+d].x,y:gs.balls[y+d][x+d].y})}counter++}for(var y=1;y<gs.balls.length;y++){var x=0;lines[counter]=[];for(var d=0;d<gs.balls.length;d++)if(x+d<gs.balls[0].length&&y+d<gs.balls.length)if(0==lines[counter].length&&null!=gs.balls[y+d][x+d])lines[counter][lines[counter].length]={color:gs.balls[y+d][x+d].color,x:gs.balls[y+d][x+d].x,y:gs.balls[y+d][x+d].y};else if(null!=gs.balls[y+d][x+d]&&lines[counter][lines[counter].length-1].color==gs.balls[y+d][x+d].color)lines[counter][lines[counter].length]={color:gs.balls[y+d][x+d].color,x:gs.balls[y+d][x+d].x,y:gs.balls[y+d][x+d].y};else{if(!(lines[counter].length<5))continue;null==gs.balls[y+d][x+d]?lines[counter]=[]:lines[counter]=new Array({color:gs.balls[y+d][x+d].color,x:gs.balls[y+d][x+d].x,y:gs.balls[y+d][x+d].y})}lines[counter].length<5&&(lines[counter]=[]),counter++}for(var i=0;i<lines.length;i++)if(!(lines[i].length<5)){for(var j=0;j<lines[i].length;j++)gs.balls[lines[i][j].y][lines[i][j].x]=null,gs.layers.context.clearRect(lines[i][j].x*gs.size[WINDOW_HEIGHT].cll.w,lines[i][j].y*gs.size[WINDOW_HEIGHT].cll.h,gs.size[WINDOW_HEIGHT].cll.w,gs.size[WINDOW_HEIGHT].cll.h);gs.account+=lines[i].length*gs.coeff,isLineClear=!0}var counter=0;lines=[];for(var x=gs.balls[0].length-1;x>=0;x--){var y=0;lines[counter]=[];for(var d=0;d<gs.balls.length;d++)if(x-d>=0&&y+d<gs.balls.length)if(0==lines[counter].length&&null!=gs.balls[y+d][x-d])lines[counter][lines[counter].length]={color:gs.balls[y+d][x-d].color,x:gs.balls[y+d][x-d].x,y:gs.balls[y+d][x-d].y};else if(null!=gs.balls[y+d][x-d]&&lines[counter][lines[counter].length-1].color==gs.balls[y+d][x-d].color)lines[counter][lines[counter].length]={color:gs.balls[y+d][x-d].color,x:gs.balls[y+d][x-d].x,y:gs.balls[y+d][x-d].y};else{if(!(lines[counter].length<5))continue;null==gs.balls[y+d][x-d]?lines[counter]=[]:lines[counter]=new Array({color:gs.balls[y+d][x-d].color,x:gs.balls[y+d][x-d].x,y:gs.balls[y+d][x-d].y})}lines[counter].length<5&&(lines[counter]=[]),counter++}for(var y=1;y<gs.balls.length;y++){var x=gs.balls[0].length-1;lines[counter]=[];for(var d=0;d<gs.balls.length;d++)if(x-d<gs.balls[0].length&&y+d<gs.balls.length)if(0==lines[counter].length&&null!=gs.balls[y+d][x-d])lines[counter][lines[counter].length]={color:gs.balls[y+d][x-d].color,x:gs.balls[y+d][x-d].x,y:gs.balls[y+d][x-d].y};else if(null!=gs.balls[y+d][x-d]&&lines[counter][lines[counter].length-1].color==gs.balls[y+d][x-d].color)lines[counter][lines[counter].length]={color:gs.balls[y+d][x-d].color,x:gs.balls[y+d][x-d].x,y:gs.balls[y+d][x-d].y};else{if(!(lines[counter].length<5))continue;null==gs.balls[y+d][x-d]?lines[counter]=[]:lines[counter]=new Array({color:gs.balls[y+d][x-d].color,x:gs.balls[y+d][x-d].x,y:gs.balls[y+d][x-d].y})}lines[counter].length<5&&(lines[counter]=[]),counter++}for(var i=0;i<lines.length;i++)if(!(lines[i].length<5)){for(var j=0;j<lines[i].length;j++)gs.balls[lines[i][j].y][lines[i][j].x]=null,gs.layers.context.clearRect(lines[i][j].x*gs.size[WINDOW_HEIGHT].cll.w,lines[i][j].y*gs.size[WINDOW_HEIGHT].cll.h,gs.size[WINDOW_HEIGHT].cll.w,gs.size[WINDOW_HEIGHT].cll.h);gs.account+=lines[i].length*gs.coeff,isLineClear=!0}var lis=document.getElementById("account").getElementsByTagName("li");switch(lis[0].innerHTML="0",lis[1].innerHTML="0",lis[2].innerHTML="0",lis[3].innerHTML="0",gs.account.toString().length){case 4:lis[0].innerHTML=gs.account.toString().substr(0,1),lis[1].innerHTML=gs.account.toString().substr(1,1),lis[2].innerHTML=gs.account.toString().substr(2,1),lis[3].innerHTML=gs.account.toString().substr(3,1);break;case 3:lis[1].innerHTML=gs.account.toString().substr(0,1),lis[2].innerHTML=gs.account.toString().substr(1,1),lis[3].innerHTML=gs.account.toString().substr(2,1);break;case 2:lis[2].innerHTML=gs.account.toString().substr(0,1),lis[3].innerHTML=gs.account.toString().substr(1,1);break;case 1:lis[3].innerHTML=gs.account.toString().substr(0,1)}1==isLineClear?this.stopAddBalls=!0:1==setballs&&this.showBall()},generateNextBalls:function(){gs.nextBalls=new Array(gs.colors[random(gs.colors.length-1)],gs.colors[random(gs.colors.length-1)],gs.colors[random(gs.colors.length-1)]);for(var li=document.getElementById("nextBalls").getElementsByTagName("li"),i=0;i<gs.nextBalls.length;i++)li[i].style.backgroundImage="url("+PATH_IMG_PUBLIC+"games/lines/"+gs.nextBalls[i]+".png)"}};