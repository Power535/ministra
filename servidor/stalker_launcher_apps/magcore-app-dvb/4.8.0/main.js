!function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=20)}([function(e,t,i){"use strict";var n=i(14);n.back=n.backspace,n.channelNext=n.tab,n.channelPrev=n.tab+"s",n.ok=n.enter,n.exit=n.escape,n.volumeUp=107,n.volumeDown=109,n.f1="112c",n.f2="113c",n.f3="114c",n.f4="115c",n.refresh="116c",n.frame="117c",n.phone="119c",n.set="120c",n.tv="121c",n.menu="122c",n.app="123c",n.rewind="66a",n.forward="70a",n.audio="71a",n.standby="74a",n.keyboard="76a",n.usbMounted="80a",n.usbUnmounted="81a",n.playPause="82a",n.play=-1,n.pause=-1,n.stop="83a",n.power="85a",n.record="87a",n.info="89a",n.mute="192a",n.digit0=48,n.digit1=49,n.digit2=50,n.digit3=51,n.digit4=52,n.digit5=53,n.digit6=54,n.digit7=55,n.digit8=56,n.digit9=57,e.exports=n},function(e,t,i){"use strict";var n=i(10),a=i(22).parse,s=new n;s.query=a(document.location.search.substring(1)),s.config=i(23),s.activePage=null,s.route=function(e,t){var i,n=s.activePage;return!(!e||e.active)&&(e.name,e.id,e.name,e.id,(i=s.activePage)&&i.active&&(i.$node.classList.remove("active"),i.active=!1,s.activePage=null,i.name,i.id,i.name,i.id,i.events["hide"]&&i.emit("hide")),function(e,t){!e||e.active||(e.$node.classList.add("active"),e.active=!0,s.activePage=e,e.name,e.id,e.name,e.id,e.events["show"]&&e.emit("show",{data:t}))}(e,t),this.events["route"]&&this.emit("route",{from:n,to:e}),!0)},e.exports=s},function(e,t,i){"use strict";var n=i(1),a=i(10),s=0;function o(e){var t,i=this;if(e=e||{},this.visible=!0,this.focusable=!0,this.$node=null,this.$body=null,this.parent=null,this.children=[],this.propagate=!!e.propagate,a.call(this),this.$node=e.$node||document.createElement("div"),this.$body=e.$body||this.$node,this.$node.className=this.name+" "+(e.className||""),this.id=e.id||this.$node.id||"cid"+s++,e.parent&&e.parent.add(this),!1===e.visible&&this.hide(),!1===e.focusable&&(this.focusable=!1),this.defaultEvents)for(t in e.events=e.events||{},this.defaultEvents)e.events[t]=e.events[t]||this.defaultEvents[t];e.events&&Object.keys(e.events).forEach(function(t){i.addListener(t,e.events[t])}),e.children&&this.add.apply(this,e.children),this.$node.addEventListener("click",function(e){i.focus(),i.events["click"]&&i.emit("click",e),e.stopPropagation()}),this.name,this.id,this.name,this.id}o.prototype=Object.create(a.prototype),o.prototype.constructor=o,o.prototype.defaultEvents=null,o.prototype.add=function(e){var t;for(t=0;t<arguments.length;t++)e=arguments[t],this.children.push(e),e.parent=this,e.$node&&null===e.$node.parentNode&&this.$body.appendChild(e.$node),e.name,e.id,this.name,this.id,this.name,this.id,e.name,e.id,this.events["add"]&&this.emit("add",{item:e})},o.prototype.remove=function(){this.parent&&(n.activePage.activeComponent===this&&(this.blur(),this.parent.focus()),this.parent.children.splice(this.parent.children.indexOf(this),1)),this.children.forEach(function(e){e.remove()}),this.$node.parentNode.removeChild(this.$node),this.events["remove"]&&this.emit("remove"),this.events={},this.name,this.id,this.name,this.id},o.prototype.focus=function(e){var t=n.activePage,i=t.activeComponent;return!(!this.focusable||this===i)&&(i&&i.blur(),t.activeComponent=i=this,i.$node.classList.add("focus"),this.name,this.id,this.name,this.id,i.events["focus"]&&i.emit("focus",e),!0)},o.prototype.blur=function(){var e=n.activePage,t=e.activeComponent;return this.$node.classList.remove("focus"),this===t?(e.activeComponent=null,this.name,this.id,this.name,this.id,this.events["blur"]&&this.emit("blur"),!0):(this.name,this.id,this.name,this.id,!1)},o.prototype.show=function(e,t){return!this.visible&&(this.$node.classList.remove("hidden"),this.visible=!0,this.name,this.id,this.name,this.id,this.events["show"]&&this.emit("show",e),"function"==typeof t&&setTimeout(t),!0)},o.prototype.hide=function(e){return!!this.visible&&(this.$node.classList.add("hidden"),this.visible=!1,this.name,this.id,this.name,this.id,this.events["hide"]&&this.emit("hide"),"function"==typeof e&&setTimeout(e),!0)},e.exports=o},function(e,t,i){"use strict";e.exports=i(2)},function(e,t,i){"use strict";var n=i(15),a=i(5);function s(e){var t=this;e=e||{},this.handlers={},this.links={},this.$noData=null,e.propagate=void 0===e.propagate||e.propagate,this.fixedData=e.fixedData||!1,e.$body=document.createElement("div"),e.$body.className="body",this.$noData=document.createElement("div"),this.$noData.className="noData hidden",n.call(this,e),this.$node.appendChild(this.$body),this.$node.appendChild(this.$noData),this.addListener("click:item",function(e){e.$item.layout.children.length&&!e.inner&&e.$item.layout.children[e.$item.layout.focusIndex].focus(),e.inner&&(t.focus(),t.focusItem(e.$item)),t.handlers[e.$item.index]&&t.handlers[e.$item.index](e.$item)})}s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.prototype.name="mag-component-layout-list",s.prototype.renderItemDefault=function(e,t){var i,n,s,o,c;if(e.ready&&this.fixedData)for(c=0;c<t.items.length;c++)"string"!=typeof(o=t.items[c]).value&&void 0!==o.value||((s=e.layout.$node.childNodes[c]).innerText=o.value||"",s.className=o.className||"");else{for(;e.firstChild;)e.removeChild(e.firstChild);n={focusable:!1,data:t.items},t.className&&(n.className=t.className),i=new a(n),t.name&&(this.links[t.name]=i),e.appendChild(i.$node),e.layout=i,i.parent=this,i.$parentItem=e,i.addListener("click",function(){i.parent.emit("click:item",{$item:e,inner:!0})}),t.click&&(this.handlers[e.index]=t.click),e.ready=!0}e.value=t.value||{}},s.prototype.setData=function(e){this.links={},n.prototype.setData.call(this,e),e.data&&e.data.length?this.$noData.classList.add("hidden"):this.$noData.classList.remove("hidden")},s.prototype.init=function(e){var t;n.prototype.init.call(this,e),e.noData&&(this.$noData.innerHTML="",e.noData instanceof Element?this.$noData.appendChild(e.noData):"string"==typeof e.noData&&((t=document.createElement("div")).innerText=e.noData,this.$noData.appendChild(t))),e.data&&e.data.length?this.$noData.classList.add("hidden"):this.$noData.classList.remove("hidden")},s.prototype.renderItem=s.prototype.renderItemDefault,e.exports=s},function(e,t,i){"use strict";var n=i(3),a=i(0);function s(e){var t=this;e=e||{},this.focusIndex=0,this.data=[],this.links={},n.call(this,e),this.init(e),this.addListener("keydown",function(e){switch(e.code){case a.right:t.children.length&&t.focusIndex<t.children.length-1&&t.children[++t.focusIndex].focus();break;case a.left:t.children.length&&t.focusIndex>0&&t.children[--t.focusIndex].focus();break;case a.back:t.parent&&(t.parent.focus(),t.$parentItem&&t.parent.focusItem(t.$parentItem))}})}s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.prototype.name="mag-component-layout",s.prototype.init=function(e){for(var t,i,a,s=this,o=function(e){var t,i;for(t=0;t<e.length;t++)"object"==typeof(i=e[t])?i instanceof n||i instanceof HTMLElement?e[t]={value:i,wrap:!1}:e[t].wrap=!0:e[t]={value:e[t],wrap:!0};return e}(e.data);this.$node.firstChild;)this.$node.removeChild(this.$node.firstChild);function c(){s.focusIndex=this.index}for(this.data=o,a=0;a<o.length;a++)"string"==typeof(t=o[a]).value?((i=document.createElement("div")).textContent=t.value,t.className&&(i.className=t.className),this.$node.appendChild(i),t.name&&(this.links[t.name]=i)):t.value instanceof HTMLElement?t.wrap?(i=document.createElement("div"),t.className&&(i.className=t.className),i.appendChild(t.value),this.$node.appendChild(i),t.name&&(this.links[t.name]=i)):(this.$node.appendChild(t.value),t.name&&(this.links[t.name]=t.value)):t.value instanceof n?(t.value.propagate=!0,t.value.index=this.children.length,t.value.addListener("click",c),t.wrap?(i=document.createElement("div"),t.className&&(i.className=t.className),i.appendChild(t.value.$node),this.$node.appendChild(i),this.children.push(t.value),t.value.parent=this,t.name&&(this.links[t.name]=i)):(this.add(t.value),t.name&&(this.links[t.name]=t.value))):(i=document.createElement("div"),t.className&&(i.className=t.className),this.$node.appendChild(i),t.name&&(this.links[t.name]=i))},e.exports=s},function(e,t,i){"use strict";var n=i(21);e.exports=n},function(e,t,i){"use strict";e.exports=i(33),e.exports.prototype.name="stb-component-page"},function(e,t,i){"use strict";var n=i(3),a=i(0),s={};function o(e){var t,i=0,a=this;(e=e||{}).focusable=!1,e.visible=e.visible||!1,e.$body=document.createElement("div"),e.$body.className="body",n.call(this,e),this.tabs=[{codes:{}},{codes:{}},{codes:{}},{codes:{}}],this.tab=0,this.$table=this.$node.appendChild(document.createElement("table")),this.$table.insertRow(),this.$table.rows[0].insertCell(-1),this.$table.rows[0].insertCell(-1),this.$table.rows[0].insertCell(-1),this.$left=this.$table.rows[0].cells[0].appendChild(document.createElement("div")),this.$left.className="theme-icon",this.$table.rows[0].cells[1].className="central",(t=this.tabs[i].$body=this.$table.rows[0].cells[1].appendChild(document.createElement("div"))).className="wrapper hidden",t.appendChild(document.createElement("div")),t.lastChild.className="button",t.lastChild.appendChild(document.createElement("div")),t.lastChild.appendChild(document.createElement("div")),t.lastChild.lastChild.className="title",(t=this.tabs[++i].$body=this.$table.rows[0].cells[1].appendChild(document.createElement("div"))).className="wrapper hidden",t.appendChild(document.createElement("div")),t.lastChild.className="button",t.lastChild.appendChild(document.createElement("div")),t.lastChild.appendChild(document.createElement("div")),t.lastChild.lastChild.className="title",t.appendChild(document.createElement("div")),t.lastChild.className="button",t.lastChild.appendChild(document.createElement("div")),t.lastChild.appendChild(document.createElement("div")),t.lastChild.lastChild.className="title",(t=this.tabs[++i].$body=this.$table.rows[0].cells[1].appendChild(document.createElement("div"))).className="wrapper hidden",t.appendChild(document.createElement("div")),t.lastChild.className="button",t.lastChild.appendChild(document.createElement("div")),t.lastChild.appendChild(document.createElement("div")),t.lastChild.lastChild.className="title",t.appendChild(document.createElement("div")),t.lastChild.className="button",t.lastChild.appendChild(document.createElement("div")),t.lastChild.appendChild(document.createElement("div")),t.lastChild.lastChild.className="title",t.appendChild(document.createElement("div")),t.lastChild.className="button",t.lastChild.appendChild(document.createElement("div")),t.lastChild.appendChild(document.createElement("div")),t.lastChild.lastChild.className="title",(t=this.tabs[++i].$body=this.$table.rows[0].cells[1].appendChild(document.createElement("div"))).className="wrapper hidden",t.appendChild(document.createElement("div")),t.lastChild.className="button",t.lastChild.appendChild(document.createElement("div")),t.lastChild.appendChild(document.createElement("div")),t.lastChild.lastChild.className="title",t.appendChild(document.createElement("div")),t.lastChild.className="button",t.lastChild.appendChild(document.createElement("div")),t.lastChild.appendChild(document.createElement("div")),t.lastChild.lastChild.className="title",t.appendChild(document.createElement("div")),t.lastChild.className="button",t.lastChild.appendChild(document.createElement("div")),t.lastChild.appendChild(document.createElement("div")),t.lastChild.lastChild.className="title",t.appendChild(document.createElement("div")),t.lastChild.className="button",t.lastChild.appendChild(document.createElement("div")),t.lastChild.appendChild(document.createElement("div")),t.lastChild.lastChild.className="title",this.$right=this.$table.rows[0].cells[2].appendChild(document.createElement("div")),this.$right.className="theme-icon",this.init(e.data),this.parent.addListener("keydown",function(e){var t=a.tabs[a.tab];a.visible&&t.codes[e.code]&&"function"==typeof t.codes[e.code].action&&t.codes[e.code].action()})}s[a.f1]="theme-icon-rc-f1",s[a.f2]="theme-icon-rc-f2",s[a.f3]="theme-icon-rc-f3",s[a.f4]="theme-icon-rc-f4",s[a.menu]="theme-icon-rc-menu",s[a.ok]="theme-icon-rc-ok",s[a.info]="theme-icon-rc-info",s[a.playPause]="theme-icon-rc-play-pause",s[a.back]="theme-icon-rc-back",s[a.exit]="theme-icon-rc-home",s[a.keyboard]="theme-icon-rc-vk",s[a.refresh]="theme-icon-rc-refresh",s[a.frame]="theme-icon-rc-aspect",o.prototype=Object.create(n.prototype),o.prototype.constructor=o,o.prototype.name="mag-component-footer",o.prototype.init=function(e){var t,i,n;function a(t){return function(){"function"==typeof e.middle[t].action&&e.middle[t].action()}}if(e=e||{},this.tabs[this.tab].$body.classList.add("hidden"),this.tab=e.middle&&e.middle.length?e.middle.length-1:0,(i=this.tabs[this.tab]).codes={},e.left?(this.$left.className=e.left.className||"theme-icon "+(s[e.left.code]||"theme-icon-warning"),e.left.disabled?this.$left.classList.add("disabled"):(i.codes[e.left.code]={action:e.left.action},this.$left.style.visibility="inherit",this.$left.onclick=function(){"function"==typeof e.left.action&&e.left.action()})):"hidden"!==this.$left.style.visibility&&(this.$left.style.visibility="hidden"),e.right?(this.$right.className=e.right.className||"theme-icon "+(s[e.right.code]||"theme-icon-warning"),e.right.disabled?this.$right.classList.add("disabled"):(i.codes[e.right.code]={action:e.right.action},this.$right.style.visibility="inherit",this.$right.onclick=function(){"function"==typeof e.right.action&&e.right.action()})):"hidden"!==this.$right.style.visibility&&(this.$right.style.visibility="hidden"),e.middle&&e.middle.length){for(t=0;t<e.middle.length;t++)i.codes[e.middle[t].code]={action:e.middle[t].action},e.middle[t].disabled?i.$body.children[t].classList.add("disabled"):(i.$body.children[t].classList.remove("disabled"),i.$body.children[t].onclick=a(t)),(n=i.$body.children[t].children)[0].className="iconImg "+(e.middle[t].className||"theme-icon "+(s[e.middle[t].code]||"theme-icon-warning")),n[1].innerText=e.middle[t].title||"";i.$body.classList.remove("hidden")}},e.exports=o},function(e,t,i){"use strict";var n=i(34),a=i(3),s=i(0);function o(e){var t,i,a,o=this;(e=e||{}).events=e.events||{},e.focusable=e.focusable||!1,e.visible=e.visible||!1,e.events.click=e.events.click||function(){o.hide()},a=e.events.keydown,e.events.keydown=function(e){a&&a.call(this,e),e.code!==s.back&&e.code!==s.menu||(e.stop=!0,o.hide())},n.call(this,e),this.$node.appendChild(document.createElement("div")),this.$node.firstChild.classList.add("alignBox"),this.$node.firstChild.appendChild(document.createElement("div")),this.$header=document.createElement("div"),this.$header.className="header",this.$text=this.$header.appendChild(document.createElement("div")),this.$text.classList.add("text"),this.$text.innerText=e.title||"",e.icon&&(this.$icon=this.$header.appendChild(document.createElement("div")),this.$icon.className="icon "+e.icon),(t=document.createElement("div")).className="overlay",i=this.$body.parentNode.removeChild(this.$body),this.$node.firstChild.firstChild.appendChild(this.$header),this.$node.firstChild.firstChild.appendChild(i),this.$node.firstChild.firstChild.appendChild(t)}o.prototype=Object.create(n.prototype),o.prototype.constructor=o,o.prototype.name="mag-component-modal",o.prototype.focus=function(){this.$node.classList.add("active"),n.prototype.focus.call(this),this.children[0]&&this.children[0]instanceof a&&this.children[0].focus()},o.prototype.blur=function(){this.$node.classList.remove("active"),n.prototype.blur.call(this)},e.exports=o},function(e,t,i){"use strict";function n(){this.events={}}n.prototype={addListener:function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)},once:function(e,t){var i=this;this.events[e]=this.events[e]||[],this.events[e].push(function n(){i.removeListener(e,n),t.apply(i,arguments)})},addListeners:function(e){var t;for(t in e)e.hasOwnProperty(t)&&this.addListener(t,e[t])},removeListener:function(e,t){this.events[e]&&(this.events[e]=this.events[e].filter(function(e){return e!==t}),0===this.events[e].length&&(this.events[e]=void 0))},emit:function(e){var t,i=this.events[e];if(i)for(t=0;t<i.length;t++)i[t].apply(this,Array.prototype.slice.call(arguments,1))}},n.prototype.constructor=n,e.exports=n},function(e,t,i){"use strict";var n={tag:function(e,t,i){var n,a,s=null;if(e){if(s=document.createElement(e),t&&"object"==typeof t)for(a in t)s[a]=t[a];for(n=2;n<arguments.length;n++)arguments[n]&&s.appendChild("object"==typeof arguments[n]?arguments[n]:document.createTextNode(arguments[n]))}return s},fragment:function(e){var t,i=document.createDocumentFragment();for(t=0;t<arguments.length;t++)(e=arguments[t])&&i.appendChild("object"==typeof e?e:document.createTextNode(e));return i},add:function(e,t){var i;if(e instanceof Node){for(i=1;i<arguments.length;i++)arguments[i]&&e.appendChild("object"==typeof arguments[i]?arguments[i]:document.createTextNode(arguments[i]));return e}return null},remove:function(e){var t,i=0;for(t=0;t<arguments.length;t++)arguments[t]&&arguments[t].parentNode&&arguments[t].parentNode.removeChild(arguments[t])===arguments[t]&&i++;return arguments.length>0&&i===arguments.length},clear:function(e){for(;e.lastChild;)e.removeChild(e.lastChild)}};e.exports=n},function(e,t,i){"use strict";e.exports=i(36),e.exports.prototype.name="stb-component-scrollbar"},function(e,t,i){"use strict";var n=i(1);e.exports=function(e){var t=document.createElement("link");t.rel="stylesheet",t.href="css/"+e+"."+n.metrics.height+".css",document.head.appendChild(t)}},function(e,t,i){"use strict";e.exports={backspace:8,tab:9,enter:13,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,del:46}},function(e,t,i){"use strict";var n=i(3),a=i(0);function s(e){e=e||{},this.$focusItem=null,this.viewIndex=null,this.data=[],this.type=this.TYPE_VERTICAL,this.size=5,this.cycle=!1,this.scroll=null,e.type&&(this.type=e.type),this.provider=null,this.type===this.TYPE_HORIZONTAL&&(e.className+=" horizontal"),n.call(this,e),this.init(e)}s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.prototype.name="mag-component-list",s.prototype.TYPE_VERTICAL=1,s.prototype.TYPE_HORIZONTAL=2,s.prototype.renderItemDefault=function(e,t){e.innerText=t.value},s.prototype.renderItem=s.prototype.renderItemDefault,s.prototype.defaultEvents={mousewheel:function(e){this.type===this.TYPE_VERTICAL&&e.wheelDeltaY&&this.move(e.wheelDeltaY>0?a.up:a.down),this.type===this.TYPE_HORIZONTAL&&e.wheelDeltaX&&this.move(e.wheelDeltaX>0?a.left:a.right)},keydown:function(e){switch(e.code){case a.up:case a.down:case a.right:case a.left:case a.pageUp:case a.pageDown:case a.home:case a.end:this.move(e.code);break;case a.enter:this.events["click:item"]&&this.$focusItem&&this.emit("click:item",{$item:this.$focusItem,event:e})}}},s.prototype.init=function(e){var t,i,n=this,a=this.$body.children.length,s=function(e){this.data&&(n.focusItem(this),n.events["click:item"]&&n.emit("click:item",{$item:this,event:e}))};if(void 0!==e.cycle&&(this.cycle=e.cycle),e.scroll&&(this.scroll=e.scroll),e.provider&&(this.provider=e.provider),e.render&&(this.renderItem=e.render),e.size&&(this.size=e.size),e.events&&Object.keys(e.events).forEach(function(t){n.events[t]=null,n.addListener(t,e.events[t])}),this.size!==a)for(a>0&&(this.$body.innerText=null),i=0;i<this.size;i++)(t=document.createElement("div")).index=i,t.className="item",t.addEventListener("click",s),this.$body.appendChild(t);if(this.provider){if(this.provider.blocked)return;this.provider.get(null,function(t,i){t?n.events["data:error"]&&n.emit("data:error",t):(i&&(e.data=i,n.setData(e),n.scroll&&n.scroll.init({realSize:n.provider.maxCount,viewSize:n.provider.size,value:n.provider.head+n.provider.pos})),n.events["data:get"]&&n.emit("data:get"))})}else e.data&&this.setData(e)},s.prototype.setData=function(e){e.data&&(this.data=function(e){var t;for(t=0;t<e.length;t++)"object"!=typeof e[t]&&(e[t]={value:e[t]});return e}(e.data)),this.viewIndex=null,this.$focusItem&&this.blurItem(this.$focusItem),this.scroll&&(this.provider?this.scroll.realSize!==this.provider.maxCount&&this.scroll.init({realSize:this.provider.maxCount,viewSize:this.provider.size,value:this.provider.head+this.provider.pos}):this.scroll.init({realSize:this.data.length,viewSize:this.size,value:e.viewIndex||0})),void 0!==e.focusIndex&&this.data.length?this.focusIndex(e.focusIndex):this.renderView(e.viewIndex||0)},s.prototype.renderView=function(e){var t,i,n,a,s;if(this.viewIndex!==e){for(a=this.viewIndex,this.viewIndex=s=e,i=0;i<this.size;i++)t=this.$body.children[i],(n=this.data[e])?(t.data=n,t.index=e,this.renderItem(t,n),n.mark?t.classList.add("mark"):t.classList.remove("mark")):(t.data=t.index=void 0,t.innerHTML="&nbsp;",t.ready=!1),e++;return this.events["move:view"]&&this.emit("move:view",{prevIndex:a,currIndex:s}),this.events["select:item"]&&this.emit("select:item",{$item:t}),this.scroll&&this.scroll.scrollTo(this.provider?this.provider.head+this.provider.pos:this.viewIndex),!0}return!1},s.prototype.move=function(e){var t=this,i=!1;if(this.data.length)switch(e){case a.left:if(this.type!==this.TYPE_HORIZONTAL)break;i=!0;case a.up:if(i||this.type===this.TYPE_VERTICAL)if(this.$focusItem&&this.$focusItem.index>0)this.$focusItem===this.$body.firstChild?this.renderView(this.viewIndex-1):this.focusItem(this.$focusItem.previousSibling);else if(this.provider){if(this.provider.blocked)return;this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n||0===n?n:t.$focusItem.index})})}else this.cycle&&this.move(a.end),this.events["overflow"]&&this.emit("overflow",{direction:e,cycle:this.cycle});break;case a.right:if(this.type!==this.TYPE_HORIZONTAL)break;i=!0;case a.down:if(i||this.type===this.TYPE_VERTICAL)if(this.$focusItem&&this.$focusItem.index<this.data.length-1)this.$focusItem===this.$body.lastChild?this.renderView(this.viewIndex+1):this.focusItem(this.$focusItem.nextSibling);else if(this.provider){if(this.provider.blocked)return;this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n||0===n?n:t.$focusItem.index})})}else this.cycle&&this.move(a.home),this.events["overflow"]&&this.emit("overflow",{direction:e,cycle:this.cycle});break;case a.pageUp:if(this.provider){if(this.provider.blocked)return;return void this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n||0})})}this.viewIndex<this.size?this.renderView(0):this.renderView(this.viewIndex-this.size+1),this.focusItem(this.$body.firstChild);break;case a.pageDown:if(this.provider){if(this.provider.blocked)return;this.provider.get(e,function(e,i,n){var a;e?t.events["data:error"]&&t.emit("data:error",e):i&&(a=n||0===n?n:i.length<t.size?i.length-1:t.size-1,t.setData({data:i,focusIndex:a}))});break}this.data.length>this.size?(this.viewIndex>this.data.length-2*this.size?this.renderView(this.data.length-this.size):this.renderView(this.viewIndex+this.size-1),this.focusItem(this.$body.lastChild)):this.focusItem(this.$body.children[this.data.length-1]);break;case a.home:if(this.provider){if(this.provider.blocked)return;this.provider.get(e,function(e,i,n){e?t.events["data:error"]&&t.emit("data:error",e):i&&t.setData({data:i,focusIndex:n||0})});break}this.renderView(0),this.focusItem(this.$body.firstChild);break;case a.end:if(this.provider){if(this.provider.blocked)return;this.provider.get(e,function(e,i,n){var a;e?t.events["data:error"]&&t.emit("data:error",e):i&&(a=n||0===n?n:i.length<t.size?i.length-1:t.size-1,t.setData({data:i,focusIndex:a}))});break}this.data.length>this.size?(this.renderView(this.data.length-this.size),this.focusItem(this.$body.lastChild)):this.focusItem(this.$body.children[this.data.length-1])}},s.prototype.focusItem=function(e){var t=this.$focusItem;return!(!e||t===e)&&(null!==t&&(t.classList.remove("focus"),this.events["blur:item"]&&this.emit("blur:item",{$item:t})),this.$focusItem=e,this.$focusItem.data=this.data[this.$focusItem.index],e.classList.add("focus"),this.events["focus:item"]&&this.emit("focus:item",{$prev:t,$curr:e}),this.events["select:item"]&&this.emit("select:item",{$item:e}),!0)},s.prototype.blurItem=function(e){return!!e&&(e===this.$focusItem&&(this.$focusItem=null),e.classList.remove("focus"),this.events["blur:item"]&&this.emit("blur:item",{$item:e}),!0)},s.prototype.focusIndex=function(e){var t=this.viewIndex||0;e>=t+this.size?(e=e<this.data.length-1?e:this.data.length-1,this.renderView(e-this.size+1),this.focusItem(this.$body.lastChild)):e<t?(e=e>0?e:0,this.renderView(e),this.focusItem(this.$body.firstChild)):(null===this.viewIndex&&this.renderView(0),this.focusItem(this.$body.children[e-t]))},s.prototype.markItem=function(e,t){t?e.classList.add("mark"):e.classList.remove("mark"),e.data.mark=t},e.exports=s},function(e,t,i){"use strict";e.exports={480:{epgGrid:6,scheduleWidth:372,timeStep:5400,countOfSteps:3,timeLineMargin:250,itemHeight:38,timeLineTop:2},576:{epgGrid:9,scheduleWidth:372,timeStep:5400,countOfSteps:3,timeLineMargin:250,itemHeight:38,timeLineTop:2},720:{epgGrid:9,scheduleWidth:830,timeStep:9e3,countOfSteps:5,timeLineMargin:350,itemHeight:48,timeLineTop:2},1080:{epgGrid:9,scheduleWidth:1245,timeStep:9e3,countOfSteps:5,timeLineMargin:525,itemHeight:72,timeLineTop:2}}[screen.height]},function(e,t,i){"use strict";var n=i(3),a=i(0);function s(e){var t,i=this;function s(e){switch(e.code){case a.left:i.focusIndex>0&&i.panels[i.focusIndex-1].focus();break;case a.right:i.focusIndex<i.panels.length-1&&i.panels[i.focusIndex+1].focus()}}for((e=e||{}).focusable=e.focusable||!1,n.call(this,e),this.panels=e.panels,this.focusIndex=0,e.panels&&!e.panels[0].main&&(e.panels[0].$node.classList.add("left"),e.panels[0].$node.classList.add("expand")),e.panels&&e.panels[1]&&e.panels[1].main&&e.panels[1].$node.classList.add("position-right"),e.panels&&e.panels[2]&&e.panels[1].main&&e.panels[2].$node.classList.add("right"),e.panels&&this.add.apply(this,e.panels),t=0;t<this.panels.length;t++)this.panels[t].addListeners({keydown:s}),this.panels[t].index=t}s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.prototype.name="mag-component-panel-set",s.prototype.focus=function(){n.prototype.focus.call(this),this.panels[this.focusIndex].focus()},s.prototype.blur=function(){this.panels[this.focusIndex].blur()},e.exports=s},function(e,t,i){"use strict";var n=i(3),a=i(5);function s(e){var t;e=e||{},this.size=1,this.main=!1,this.index=0,e.$body=document.createElement("div"),e.$body.className="body",n.call(this,e),e.size&&(this.size=e.size,this.$node.classList.add("size"+e.size)),e.main&&(this.main=!0,this.$node.classList.add("main")),this.$shadow={left:document.createElement("div"),right:document.createElement("div")},this.$shadow.left.className="shadow left",this.$node.appendChild(this.$shadow.left),this.$shadow.right.className="shadow right",this.$node.appendChild(this.$shadow.right),e.title&&(Array.isArray(e.title)||(e.title=[e.title]),this.$title=new a({className:"title",data:e.title,focusable:!1}),this.$node.appendChild(this.$title.$node)),this.$node.appendChild(this.$body),(t=document.createElement("div")).className="overlay",this.$node.appendChild(t)}s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.prototype.name="mag-component-panel",s.prototype.defaultEvents={focus:function(){this.children.length&&this.children[0].focus()}},s.prototype.focus=function(){this.focusable&&(this.parent.panels[this.parent.focusIndex].$node.classList.remove("active"),this.parent.panels[this.parent.focusIndex].$node.classList.remove("top"),n.prototype.focus.call(this),this.parent.focusIndex=this.index,this.$node.classList.add("active"),this.$node.classList.add("top"),0===this.index&&this.parent.panels[1]&&this.parent.panels[1].main?(this.parent.panels[1].$node.classList.remove("position-left"),this.parent.panels[1].$node.classList.add("position-right"),this.parent.panels[2]&&this.parent.panels[2].$node.classList.remove("expand"),this.$node.classList.add("expand")):2===this.index&&this.parent.panels[1].main&&(this.parent.panels[1].$node.classList.remove("position-right"),this.parent.panels[1].$node.classList.add("position-left"),this.parent.panels[0].$node.classList.remove("expand"),this.$node.classList.add("expand")))},s.prototype.blur=function(){this.parent.panels[this.parent.focusIndex].$node.classList.remove("active"),n.prototype.blur.call(this)},e.exports=s},function(e,t,i){"use strict";var n=i(15),a="theme-icon theme-icon-radio",s="theme-icon theme-icon-radio-active";function o(e){var t=this;e.classIcon&&(a=e.classIcon),e.classIconActive&&(s=e.classIconActive),e.classChecked&&(a=e.classChecked),this.checkedData=null,this.checkedIndex=null,n.call(this,e),this.addListener("click:item",function(e){var i=e.$item,n=t.checkedData;t.checkIndex(i.index),n!==i.data&&t.emit("select",i)})}o.prototype=Object.create(n.prototype),o.prototype.constructor=o,o.prototype.name="mag-component-radio-list",o.prototype.init=function(e){e=e||{},n.prototype.init.call(this,e)},o.prototype.setData=function(e){n.prototype.setData.call(this,e),this.defaultCheckedIndex=this.checkedIndex,this.$focusItem?this.defaultFocusIndex=this.$focusItem.index:this.defaultFocusIndex=0},o.prototype.resetData=function(){this.checkIndex(this.defaultCheckedIndex),this.focusIndex(this.defaultFocusIndex)},o.prototype.clearChecked=function(e){for(var t=0;t<this.data.length;t++)this.data[t].state=!1;e||0===e||(e=this.$focusItem?this.$focusItem.index:0),this.setData({data:this.data,focusIndex:e})},o.prototype.renderItemDefault=function(e,t){var i,n,o,c;e.ready?(e.$title.innerText=t.title||"",t.state?(e.classList.add("checked"),e.checkBox.className=s):(e.classList.remove("checked"),e.checkBox.className=a),e.state=t.state,e.value=t.value):(e.innerHTML="",i=document.createElement("table"),n=document.createElement("tr"),o=document.createElement("td"),c=document.createElement("div"),t.state?(e.classList.add("checked"),c.className=s):(e.classList.remove("checked"),c.className=a),i.appendChild(n),o.appendChild(c),o.className="checkBoxWrapper",n.appendChild(o),(o=document.createElement("td")).className="title",o.innerText=t.title||"",n.appendChild(o),e.checkBox=c,e.state=t.state,e.value=t.value,e.$title=o,e.appendChild(i),t.state&&(this.checkedData=t,this.checkedIndex=e.index),e.ready=!0)},o.prototype.checkIndex=function(e){var t;e!==this.checkedIndex&&(null!==this.checkedIndex&&this.$node.children.length&&(this.data[this.checkedIndex].state=!1,(t=this.getItemNodeByIndex(this.checkedIndex))&&(t.checkBox.className=a,t.classList.remove("checked"))),(t=this.getItemNodeByIndex(e))&&(t.checkBox.className=s,t.classList.add("checked"),t.state=!0),this.data[e].state=!0,this.checkedData=this.data[e],this.checkedIndex=e)},o.prototype.getItemNodeByIndex=function(e){var t=this.$node.children;return(e-=this.viewIndex)<this.size&&e>=0?t[e]:null},o.prototype.renderItem=o.prototype.renderItemDefault,e.exports=o},function(e,t,i){"use strict";var n=i(6),a=(i(0),i(29));i(31),n.intents={osdInput:null,osdTv:null},n.once("load",function(){n.provider=core.plugins.dvb,a.load({name:core.environment.language||"en"},function(e){var t=new(i(32))({$node:document.getElementById("pageEpg"),apiProvider:n.provider});t.addListener("back",function(e){n.route(n.pages.main,e)}),core.addListener("intent",function(e,t){t(!1,{})}),n.pages={main:i(38),epg:t},n.pages.scanOptions=i(44),n.pages.scanning=i(47),n.route(n.pages.main)})})},function(e,t,i){"use strict";var n=i(1),a=i(24);window.core=window.parent.getCoreInstance(window,n),i(25),i(26),i(13)("sdk"),i(28),i(13)("app"),n.platform="mag",n.ready=function(){window.core.call("app:ready")},n.exit=function(){n.events["exit"]&&n.emit("exit"),core.call("exit")},a.load=function(e){document.body.setAttribute("platform",n.platform),core.ready?n.events["load"]&&n.emit("load",{}):core.once("load",function(){n.events[e.type]&&n.emit(e.type,e)})},a.contextmenu=function(e){e.preventDefault()},Object.keys(a).forEach(function(e){window.addEventListener(e,a[e])}),e.exports=n},function(e,t,i){"use strict";e.exports={parse:function(e){var t={};return e.split("&").forEach(function(e){2===(e=e.split("=")).length&&(t[e[0]]=decodeURIComponent(e[1]))}),t},stringify:function(e){var t=[];return Object.keys(e).forEach(function(i){t.push(i+"="+encodeURIComponent(e[i]))}),t.join("&")}}},function(e,t,i){"use strict";e.exports={}},function(e,t,i){"use strict";var n=i(1);e.exports={DOMContentLoaded:function(e){n.events["dom"]&&n.emit("dom",e)},load:function(e){n.events[e.type]&&n.emit(e.type,e)},unload:function(e){n.events[e.type]&&n.emit(e.type,e)},error:function(e){},keydown:function(e){var t,i=n.activePage,a={code:e.keyCode,stop:!1};e.ctrlKey&&(a.code+="c"),e.altKey&&(a.code+="a"),e.shiftKey&&(a.code+="s"),(t=i.activeComponent)&&t!==i&&(t.events[e.type]&&t.emit(e.type,a,e),!a.stop&&t.propagate&&t.parent&&t.parent.events[e.type]&&t.parent.emit(e.type,a,e)),a.stop||(i.events[e.type]&&i.emit(e.type,a,e),e.stop||n.events[e.type]&&n.emit(e.type,a,e))},keypress:function(e){var t=n.activePage;t.activeComponent&&t.activeComponent!==t&&t.activeComponent.events[e.type]&&t.activeComponent.emit(e.type,e)},mousewheel:function(e){var t=n.activePage;t.activeComponent&&t.activeComponent!==t&&t.activeComponent.events[e.type]&&t.activeComponent.emit(e.type,e),e.stop||t.events[e.type]&&t.emit(e.type,e)}}},function(e,t,i){"use strict";if(!document.documentElement.classList){var n=Array.prototype,a=n.indexOf,s=n.slice,o=n.push,c=n.splice,l=n.join;window.DOMTokenList=function(e){if(this._element=e,e.className!==this._classCache){if(this._classCache=e.className,!this._classCache)return;var t,i=this._classCache.replace(/^\s+|\s+$/g,"").split(/\s+/);for(t=0;t<i.length;t++)o.call(this,i[t])}},window.DOMTokenList.prototype={add:function(e){this.contains(e)||(o.call(this,e),this._element.className=s.call(this,0).join(" "))},contains:function(e){return-1!==a.call(this,e)},item:function(e){return this[e]||null},remove:function(e){var t=a.call(this,e);-1!==t&&(c.call(this,t,1),this._element.className=s.call(this,0).join(" "))},toString:function(){return l.call(this," ")},toggle:function(e){return this.contains(e)?this.remove(e):this.add(e),this.contains(e)}},Object.defineProperty(Element.prototype,"classList",{get:function(){return new window.DOMTokenList(this)}})}},function(e,t,i){"use strict";var n=i(1),a=i(27);n.metrics=a[n.query.screenHeight]||a[screen.height]||a[720],n.metrics.availHeight=n.metrics.height-(n.metrics.availTop+n.metrics.availBottom),n.metrics.availWidth=n.metrics.width-(n.metrics.availLeft+n.metrics.availRight)},function(e,t,i){"use strict";e.exports={480:{height:480,width:720,availTop:24,availBottom:24,availRight:32,availLeft:48},576:{height:576,width:720,availTop:24,availBottom:24,availRight:26,availLeft:54},720:{height:720,width:1280,availTop:30,availBottom:30,availRight:40,availLeft:40},1080:{height:1080,width:1920,availTop:45,availBottom:45,availRight:60,availLeft:60}}},function(e,t,i){"use strict";var n,a=i(1);(n=document.createElement("link")).rel="stylesheet",n.href=window.core.theme.path+a.metrics.height+".css",document.head.appendChild(n),e.exports=n},function(e,t,i){"use strict";var n=i(10),a=i(30),s=new n;function o(e){var t=new a(e);return window.gettext=window._=t.gettext,window.pgettext=t.pgettext,window.ngettext=t.ngettext,t}s.defaultLanguage="en",s.load=function(e,t){var i;return e.ext=e.ext||"json",e.path=e.path||"lang",e.name===s.defaultLanguage?(o(),t(null),!1):((i=new XMLHttpRequest).onload=function(){try{o(JSON.parse(i.responseText)),t(null),s.events["load"]&&s.emit("load")}catch(e){i.onerror(e)}},i.ontimeout=i.onerror=function(e){o(),t(e),s.events["error"]&&s.emit("error",e)},i.open("GET",e.path+"/"+e.name+"."+e.ext,!0),i.send(null),!0)},e.exports=s},function(module,exports,__webpack_require__){"use strict";function Gettext(config){var data,meta;config=config||{},data=config.data||{},data[""]=data[""]||{},meta=config.meta,this.gettext=function(e){return data[""][e]||e},this.pgettext=function(e,t){return data[e]&&data[e][t]||t},this.ngettext=function(msgId,plural,value){var n,evalResult;return data&&meta&&data[""][msgId]?(evalResult=eval("n = "+value+"; "+meta.plural),"boolean"==typeof evalResult&&(evalResult=+evalResult),data[""][msgId][evalResult]):1===value?msgId:plural}}Gettext.prototype.constructor=Gettext,module.exports=Gettext},function(e,t,i){"use strict";Array.prototype.findIndex||(Array.prototype.findIndex=function(e){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,i=Object(this),n=i.length>>>0,a=arguments[1],s=0;s<n;s++)if(t=i[s],e.call(a,t,s,i))return s;return-1})},function(e,t,i){"use strict";var n,a,s,o,c,l,r,d,u=i(7),h=i(11).tag,m=i(0),p=i(8),f=i(9),v=i(4),g=i(5),y=i(12),x=i(37);function $(e){var t,i,n,a,s,o=[],c=[];for(a=0;a<e.length;a++)s=h("div",{className:"logo"}),e[a].logo&&(s.style.backgroundImage="url("+core.backend.host+e[a].logo+")"),n=e[a].censored||e[a].genre&&e[a].genre.censored,c=[{className:"number",value:e[a].number.toString()},s,{className:"name",value:e[a].name},{className:e[a].archive?"theme-icon theme-icon-timeshift disabled":"theme-icon hidden"},{className:n?"theme-icon theme-icon-lock disabled":"theme-icon hidden"},{className:"arrowLeft theme-epg-grid-arrow-left"},{className:"arrowRight theme-epg-grid-arrow-right"},{className:"theme-epg-grid-timeshift hidden"}],t=new g({focusable:!1,data:c,className:"channel theme-epg-grid-main",events:{click:function(){this.parent.emit("click")}}}),i=new g({focusable:!1,className:"schedule",data:[],events:{click:function(){this.parent.emit("click")}}}),t.listIndex=a,i.listIndex=a,o.push({value:e[a],items:[t,i],censored:n});return o}function b(){var e,t=l.$focusItem.data.value;l.epgLastFocused&&(e=l.epgLastFocused.data),core.intent({action:"record",data:{uri:t.url,name:t.name,epgName:t.name,startTime:e?e.start:l.time,endTime:e?e.end:l.time+l.timeStep,id:t.id,pvr:{server:t.pvr,local:t.local_pvr}}},function(){})}function I(e){var t=this;e.className="magcore-page-epg"+(e.className?" "+e.className:""),u.call(this,e),this.addListener("show",function(e){l.focusIndex(e.data.index),l.focus(),l.startCheck()}),this.addListener("keydown",function(e){switch(e.code){case m.back:l.stopCheck(),t.emit("back",l.$focusItem)}}),o=new g({focusable:!1,data:[{name:"$title",className:"title",value:gettext("TV Guide")},{name:"$current",className:"current"},{name:"$description",className:"description"}],className:"header-layout theme-epg-grid-main"}),this.add(o),c=new g({focusable:!1,data:[{className:"time"},{name:"$timeline",className:"timeline theme-epg-grid-timeline"}],className:"content"}),this.add(c),l=new x({className:"epg-list",size:i(16).epgGrid,events:{"click:item":function(e){var i=e.$item;i.data.value.epgItems.length?i.data.value.epgItems[i.data.value.epgFocus]&&(i.data.value.archive&&i.data.value.epgItems[i.data.value.epgFocus].data.archive?t.emit("epg:click",{channelIndex:i.index,epg:i.data.value.epgItems[i.data.value.epgFocus].data}):t.emit("channel:click",{channelIndex:i.index})):t.emit("channel:click",{channelIndex:i.index})},"focus:item":function(e){var t=e.$curr,i=[];e={left:{},middle:[],label:{code:m.menu,title:gettext("Hold OK button to open Options menu"),action:function(){a.show(),a.focus()}}},(t.data.value.pvr||t.data.value.local_pvr)&&(e.middle.push({code:m.f1,title:gettext("Record"),action:b}),i.push({items:[{className:d.record},{className:"title",value:gettext("Record")}],click:function(){a.hide(),b()}})),i.push({items:[{className:d.realtime},{className:"title",value:gettext("To real time")}],click:function(){a.hide(),l.goToRealTime()}}),e.middle.push({code:m.f3,title:gettext("To real time"),action:function(){l.goToRealTime()}}),e.left={code:m.menu,action:function(){a.show(),a.focus()}},n.init(e),s.init({data:i,size:i.length,focusIndex:0})}},noData:gettext("No Channels"),apiProvider:e.apiProvider,focusIndex:0,scroll:r=new y,$timeBlock:c.$node.children[0],$programDescription:o.links.$description,$programName:o.links.$current,$timeLine:c.links.$timeline}),c.add(l),c.add(r),(n=new p({visible:!1,parent:this})).init({left:{code:m.menu,action:function(){a.show(),a.focus()}},middle:[{code:m.f1,title:gettext("Record"),action:b},{code:m.f3,title:gettext("To real time"),action:function(){l.goToRealTime()}}],label:{code:m.menu,title:gettext("Hold OK button to open Options menu"),action:function(){a.show(),a.focus()}}}),n.show(),this.add(a=new f({title:gettext("Actions"),className:"width2x",events:{show:function(){n.hide(),this.children[0].focus()},hide:function(){n.show(),l.focus()}},children:[s=new v({size:2,focusIndex:0,cycle:!0,data:[{items:[{className:d.record},{className:"title",value:gettext("Record")}],click:function(){a.hide(),b()}},{items:[{className:d.realtime},{className:"title",value:gettext("To real time")}],click:function(){a.hide(),l.goToRealTime()}}],events:{keydown:function(e){switch(v.prototype.defaultEvents.keydown.call(this,e),e.code){case m.menu:case m.back:a.hide(),e.stop=!0}}}})]}))}d={realtime:"theme-icon theme-icon-rc-f3",record:"theme-icon theme-icon-rc-f1"},I.prototype=Object.create(u.prototype),I.prototype.constructor=I,I.prototype.setChannels=function(e){l.setData({data:$(e),focusIndex:0}),l.updateEpg()},e.exports=I},function(e,t,i){"use strict";var n=i(2);function a(e){e=e||{},this.active=!1,this.activeComponent=null,n.call(this,e),this.active=this.$node.classList.contains("active"),null===this.$node.parentNode&&document.body.appendChild(this.$node),this.page=this}a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.prototype.name="spa-component-page",e.exports=a},function(e,t,i){"use strict";e.exports=i(35),e.exports.prototype.name="stb-component-modal"},function(e,t,i){"use strict";var n=i(2);function a(e){(e=e||{}).$body=document.createElement("div"),e.$body.className="body",n.call(this,e),this.$node.appendChild(document.createElement("div").appendChild(this.$body).parentNode)}a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.prototype.name="spa-component-modal",e.exports=a},function(e,t,i){"use strict";var n=i(2);function a(e){e=e||{},this.viewSize=10,this.realSize=100,this.value=0,this.type=this.TYPE_VERTICAL,this.thumbRect=null,this.trackRect=null,e.focusable=e.focusable||!1,e.type&&(this.type=e.type),this.type===this.TYPE_HORIZONTAL&&(e.className+=" horizontal"),n.call(this,e),this.$thumb=this.$body.appendChild(document.createElement("div")),this.$thumb.className="thumb",this.init(e)}a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.prototype.name="spa-component-scrollbar",a.prototype.TYPE_VERTICAL=1,a.prototype.TYPE_HORIZONTAL=2,a.prototype.init=function(e){void 0!==(e=e||{}).realSize&&(this.realSize=e.realSize),void 0!==e.viewSize&&(this.viewSize=e.viewSize),this.viewSize>=this.realSize?this.$thumb.classList.add("hidden"):this.$thumb.classList.remove("hidden"),void 0!==e.value&&this.scrollTo(e.value),this.type===this.TYPE_VERTICAL?this.$thumb.style.height=this.viewSize/this.realSize*100+"%":this.$thumb.style.width=this.viewSize/this.realSize*100+"%",this.thumbRect=this.$thumb.getBoundingClientRect(),this.trackRect=this.$node.getBoundingClientRect()},a.prototype.scrollTo=function(e){return this.value!==e&&(0!==this.thumbRect.height&&0!==this.thumbRect.width||(this.trackRect=this.$node.getBoundingClientRect(),this.thumbRect=this.$thumb.getBoundingClientRect()),this.type===this.TYPE_VERTICAL?this.$thumb.style.marginTop=(this.trackRect.height-this.thumbRect.height)*e/(this.realSize-this.viewSize)+"px":this.$thumb.style.marginLeft=(this.trackRect.width-this.thumbRect.width)*e/(this.realSize-this.viewSize)+"px",this.events["change"]&&this.emit("change",{curr:e,prev:this.value}),e>=this.realSize&&(e=this.realSize,this.events["done"]&&this.emit("done")),this.value=e,!0)},e.exports=a},function(e,t,i){"use strict";var n=i(11),a=i(0),s=i(5),o=i(4),c=i(16),l=[gettext("January"),gettext("February"),gettext("March"),gettext("April"),gettext("May"),gettext("June"),gettext("July"),gettext("August"),gettext("September"),gettext("October"),gettext("November"),gettext("December")],r=[gettext("Sunday "),gettext("Monday "),gettext("Tuesday "),gettext("Wednesday "),gettext("Thursday "),gettext("Friday "),gettext("Saturday ")];function d(e){this.scheduleWidth=c.scheduleWidth,this.time=null,this.day=0,this.timeStep=c.timeStep,this.countOfSteps=c.countOfSteps,this.scheduleBlock=this.scheduleWidth/this.timeStep,this.step=this.timeStep/this.countOfSteps,this.timeLineMargin=c.timeLineMargin,this.itemHeight=c.itemHeight,this.timeLineTop=c.timeLineTop,this.$timeBlock=e.$timeBlock,this.$programDescription=e.$programDescription,this.$programName=e.$programName,this.$timeLine=e.$timeLine,this.$timeLine.appendChild(n.tag("div",{className:"timemark theme-epg-grid-timemark"})),this.timers={},this.internal={},this.epgMode=0,this.epgFocusTime=null,this.epgLastFocused=null,e.events||(e.events={}),e.events.keydown||(e.events.keydown=function(e){switch(e.code){case a.right:case a.left:this.moveEpg(e.code);break;case a.up:case a.down:case a.pageUp:case a.pageDown:case a.home:case a.end:this.move(e.code);break;case a.enter:e.stop=!0,this.pressOk()}}),this.apiProvider=e.apiProvider,o.call(this,e)}d.prototype=Object.create(o.prototype),d.prototype.constructor=d,d.prototype.renderItem=function(e,t){for(var i,n,a,o=this;e.firstChild;)e.removeChild(e.firstChild);a={focusable:!1,data:t.items},t.className&&(a.className=t.className),t.events?a.events=t.events:a.events={click:function(){o.focusItem(e),o.pressOk()}},i=new s(a),e.appendChild(i.$node),e.layout=i,i.parent=this,i.$parentItem=e,n=t.items[0].value.$node.children,e.censored=t.censored,e.domLinks={$number:n[0],$icon:n[1],$title:n[2],$archiveIcon:n[3],$lockIcon:n[4],$archiveLine:n[7]},t.click&&(this.handlers[e.index]=t.click),e.ready=!0,e.value=t.value||{},t.value.archive?(t.value.$archiveLine=e.domLinks.$archiveLine,e.domLinks.$archiveLine.classList.remove("hidden")):(t.value.$archiveLine=null,e.domLinks.$archiveLine.classList.add("hidden")),t&&this.fillItem(e,t)},d.prototype.setData=function(e){o.prototype.setData.call(this,e),this.data.length<this.size?this.$timeLine.style.height=this.itemHeight*this.data.length+this.timeLineTop+"px":this.$timeLine.style.height=this.itemHeight*this.size+this.timeLineTop+"px"},d.prototype.moveEpg=function(e){switch(e){case a.left:this.subPrev();break;case a.right:this.subNext()}},d.prototype.pressOk=function(){this.events["click:item"]&&this.$focusItem&&this.emit("click:item",{$item:this.$focusItem,event:event})},d.prototype.onFocus=function(e){var t,i,n=this,a=0;this.repositionTimeLine(),this.timers.onFocus&&clearTimeout(this.timers.onFocus),this.epgMode&&(this.timers.onFocus=setTimeout(function(){if((i=e.$curr.data).value.epgItems.length){for(t=0;t<i.value.epgItems.length;t++)if(n.epgFocusTime>=i.value.epgItems[t].data.start&&n.epgFocusTime<i.value.epgItems[t].data.end){a=t;break}i.value.epgFocus=a,n.focusEpg(i.value.epgItems[i.value.epgFocus],!0)}else n.epgLastFocused&&(n.epgLastFocused.classList.remove("theme-epg-grid-focused"),n.epgLastFocused.focused=!1),n.epgLastFocused=null},core.environment.onFocusDebounceTimeout))},d.prototype.onOverflow=function(){var e=this;this.timers.onOverflow&&clearTimeout(this.timers.onOverflow),this.timers.onOverflow=setTimeout(function(){e.updateEpg()},core.environment.onFocusDebounceTimeout)},d.prototype.init=function(e){o.prototype.init.call(this,e),this.addListener("focus:item",this.onFocus),this.addListener("move:view",this.onOverflow)},d.prototype.startCheck=function(){this.checkingTime()},d.prototype.stopCheck=function(){var e;for(e in this.internal)clearInterval(this.internal[e]);for(e in this.timers)clearTimeout(this.timers[e])},d.prototype.fillItem=function(e,t){var i,a,s,o=0,c=[],l=this.time;if(n.clear(t.items[1].value.$node),(!e.censored||core.accessControl.state)&&t.value.epgGrid&&t.value.epgGrid.length){for(a=0;a<t.value.epgGrid.length&&!((s=t.value.epgGrid[a]).start>=this.time+this.timeStep-60);a++)s.end>this.time&&(s.start>=l+60&&(i=n.tag("div",{className:"program theme-epg-grid-noData"},n.tag("div",{className:"text",data:{focusable:!1}},gettext("No data"))),o=(s.start-l)*this.scheduleBlock,o=Math.floor(o)-2,i.children[0].style.width=o+"px",n.add(t.items[1].value.$node,i),l=s.start),s.focusable=!0,i=n.tag("div",{className:"program theme-epg-grid-default"},n.tag("div",{className:"text",data:s},s.title)),o=s.end<this.time+this.timeStep?(s.end-l)*this.scheduleBlock:(this.time+this.timeStep-l)*this.scheduleBlock,o=Math.floor(o)-2,l=s.end,i.children[0].style.width=o+"px",i.data=s,n.add(t.items[1].value.$node,i),c.push(i)),t.value.epgItems=c;l<this.time+this.timeStep&&(o=(this.time+this.timeStep-l)*this.scheduleBlock)>4&&(i=n.tag("div",{className:"program theme-epg-grid-noData"},n.tag("div",{className:"text",data:{focusable:!1}},gettext("No data"))),o=Math.floor(o)-2,i.children[0].style.width=o+"px",n.add(t.items[1].value.$node,i))}else(i=n.tag("div",{className:"program theme-epg-grid-noData"},n.tag("div",{className:"text",data:{focusable:!1}},gettext("No data")))).children[0].style.width=this.scheduleWidth-2+"px",n.add(t.items[1].value.$node,i),t.value.epgItems=[]},d.prototype.checkCurrent=function(){var e,t,i,n,a=this,s=this.$focusItem,o=Date.now()/1e3;function c(e,i){t&&e.data&&o>e.data.start&&o<e.data.end?(e.classList.add("theme-epg-grid-current"),t=!1,a.epgMode||n!==s||(a.focusEpg(e,!0),s.data.value.epgFocus=i)):(e.classList.remove("theme-epg-grid-current"),a.epgMode||a.$body.children[i]!==s||e.classList.remove("theme-epg-grid-focused"))}for(i=0;i<this.$body.children.length;i++)t=!0,(n=this.$body.children[i]).data&&n.data.value.epgItems&&n.data.value.epgItems.length&&n.data.value.epgItems.forEach(c);s&&s.data.value.$archiveLine&&(s.data.value.epgGrid&&s.data.value.epgGrid.length?this.time+this.timeStep>o?o>=this.time?(e=Math.ceil((o-this.time)*this.scheduleBlock),s.data.value.$archiveLine.style.width=e+"px",s.data.value.$archiveLine.style.display=""):s.data.value.$archiveLine.style.display="none":s.data.value.$archiveLine.style.width=this.scheduleWidth+"px":s.data.value.$archiveLine.style.display="none")},d.prototype.setCurrentProgram=function(){this.epgLastFocused&&this.epgLastFocused.data?(this.$programDescription.innerText=this.epgLastFocused.data.description||"",this.$programName.innerText=this.epgLastFocused.data.title||""):(this.$programDescription.innerText="",this.$programName.innerText="")},d.prototype.repositionTimeLine=function(){var e=new Date,t=0,i=Math.ceil(e.getTime()/1e3);i>=this.time&&this.time+this.timeStep>i?(t=Math.ceil((i-this.time)/this.timeStep*this.scheduleWidth),t+=this.timeLineMargin,this.$timeLine.style.display="block",this.$timeLine.style.left=t+"px"):this.$timeLine.style.display="none",this.checkCurrent()},d.prototype.epgModeChange=function(e){var t=this;this.epgMode=!!e,this.timers.epgModeChange&&clearTimeout(this.timers.epgModeChange),this.epgMode&&(this.timers.epgModeChange=setTimeout(function(){t.goToRealTime()},18e4))},d.prototype.checkingTime=function(){var e=this.getStartTime(),t=this;this.internal.checkingTime&&clearInterval(this.internal.checkingTime),this.epgMode||(this.time!==e&&(this.time=e),this.initTimeBlock(),this.internal.checkingTime=setInterval(function(){t.epgMode||(e=t.getStartTime(),t.time!==e&&(t.time=e,t.initTimeBlock())),t.repositionTimeLine()},6e4))},d.prototype.initTimeBlock=function(e,t){var i,a,s,o,c,d,u,h;for(null===this.time&&(this.time=this.getStartTime()),d=this.time-this.step/2,i=new Date(1e3*d),a=r[i.getDay()],s=i.getMinutes(),o=i.getHours(),c=i.getMonth()+1,u=a+", "+i.getDate()+" "+l[c-1],n.clear(this.$timeBlock),n.add(this.$timeBlock,n.tag("div",{className:"date theme-epg-grid-date"},u)),h=2;h<=2*this.countOfSteps;h+=2)i.setTime(1e3*(d+h*this.step/2)),s=i.getMinutes(),o=i.getHours(),n.add(this.$timeBlock,n.tag("div",{className:"hours theme-epg-grid-date "+(30===s?"halfhour":"hour")},(o<10?"0"+o:o)+":"+(s<10?"0"+s:s),n.tag("div",{className:"hourmark theme-epg-grid-hourmark"})));this.updateEpg(e,t)},d.prototype.getStartTime=function(){var e,t,i=new Date;return t=Math.floor(i.getTime()/1e3),(e=60*i.getMinutes()%(2*this.step))<this.step?t-e-this.step/2:t-e+this.step/2},d.prototype.updateEpg=function(e,t){var i,a,s,o=[],c={},l=this;for(i=0;i<this.$body.children.length;i++)this.$body.children[i].data&&o.push(this.$body.children[i].data.value);if(0!==o.length){for(c.channels=o,this.time||(this.time=this.getStartTime()),c.from=1e3*this.time,c.to=c.from+1e3*this.timeStep,this.request&&this.request.abort(),a=this.$body.children.length,s=this.data.length,i=0;i<a&&this.$body.children[i].index<s;i++)n.clear(this.data[this.$body.children[i].index].items[1].value.$node);this.request=this.apiProvider.getChannelsEpg(c,function(n,a){if(!n)for(i=0;i<o.length;i++)a[o[i].id]?o[i].epgGrid=a[o[i].id]:o[i].epgGrid=null;for(i=0;i<l.$body.children.length;i++)l.$body.children[i].data&&l.fillItem(l.$body.children[i],l.data[l.$body.children[i].index]);if(l.checkCurrent(),l.epgMode)if((a=l.$focusItem.data).value.epgItems.length){if(e)a.value.epgFocus=a.value.epgItems.length-1;else if(t)a.value.epgFocus=0;else for(a.value.epgFocus=0,i=0;i<a.value.epgItems.length;i++)if(l.epgFocusTime>=a.value.epgItems[i].data.start&&l.epgFocusTime<a.value.epgItems[i].data.end){a.value.epgFocus=i;break}l.focusEpg(a.value.epgItems[a.value.epgFocus],!0)}else l.focusEpg(l.epgLastFocused,!1)}),this.repositionTimeLine()}},d.prototype.focusEpg=function(e,t){t=!!t,e.focused!==t&&(t?(this.epgLastFocused&&(this.epgLastFocused.classList.remove("theme-epg-grid-focused"),this.epgLastFocused.focused=!1),e.classList.add("theme-epg-grid-focused"),e.focused=!0,this.epgLastFocused=e,this.epgFocusTime=e.data.start,this.setCurrentProgram()):(e.classList.remove("theme-epg-grid-focused"),e.focused=!1,this.epgLastFocused===e&&(this.epgLastFocused=null,this.epgFocusTime=this.time,this.setCurrentProgram())))},d.prototype.subNext=function(){var e=this.$focusItem.data;this.epgModeChange(!0),e.value.epgItems.length&&e.value.epgFocus+1<e.value.epgItems.length?(e.value.epgFocus++,this.focusEpg(e.value.epgItems[e.value.epgFocus],!0)):(this.time+=this.timeStep-this.step,this.initTimeBlock(!1,!0))},d.prototype.subPrev=function(){var e=this.$focusItem.data;this.epgModeChange(!0),e.value.epgItems.length>0&&e.value.epgFocus>0?(e.value.epgFocus--,this.focusEpg(e.value.epgItems[e.value.epgFocus],!0)):(this.time-=this.timeStep-this.step,this.initTimeBlock(!0))},d.prototype.goToRealTime=function(){var e=this.getStartTime();this.epgMode&&(this.epgModeChange(!1),this.time!==e&&(this.time=e,this.initTimeBlock()))},e.exports=d},function(e,t,i){"use strict";var n,a,s,o,c,l,r,d,u,h,m,p,f,v,g,y,x=new(i(7))({$node:document.getElementById("pageChannels")}),$=i(6),b=i(39),I=i(40),w=i(17),k=i(18),C=i(4),T=i(19),N=i(9),E=i(12),L=i(8),S=$.provider,D=i(0),P={channelList:new E,categoryList:new E,epg:new E},z=i(41),O=[],F=!1,A=1500,R=null,M=i(42),B={config:{favorite:!1,byName:!1,genre:!1,search:""},lastActiveState:{config:{favorite:!1,byName:!1,genre:!1,search:""}},list:[],epg:{list:[],currentPlayIndex:0},current:null,currentIndex:void 0,epgTimeout:null,footerInitDelay:null,epgUpdateTimeout:null,context:null,lastChannelTimeout:null,channelFooterTimeout:null,channelListEpgTimeout:null,channelListEpgInterval:null},q=document.createElement("div"),_=document.createElement("div"),V=document.createElement("div"),j=document.createElement("div"),H=3e5,G=!!$.provider.antennaPower,Y=7e3,W=!1,K=1e3;function U(e){e.forEach(function(e){null!==e&&e.close()})}function J(e){var t,i,n,a,s,o,c=[];if(!e||e.length<1)return[];for(t=0;t<e.length;t++)n=document.createElement("div"),(a=document.createElement("div")).className="name",(o=document.createElement("div")).className="epg"+(e[t].currentEpg?" visible":""),a.innerText=e[t].name,e[t].currentEpg&&e[t].currentEpg.title?(o.innerText=e[t].currentEpg.title,s=e[t].currentEpg.title):(o.innerText="",s=""),n.appendChild(a),n.appendChild(o),(i={items:[{className:"number"+(e[t]["monitoring_status"]?"":" monitoringFail"),value:e[t].number.toString()}],value:e[t]}).items=i.items.concat([{className:"title"+(e[t]["monitoring_status"]?"":" monitoringFail"),value:n,htmlInstance:!0,realValue:{name:e[t].name,epg:s}},{className:e[t].censored||e[t].genre.censored?"theme-icon theme-icon-lock disabled":""},{className:e[t].archive||e[t].local_timeshift?"theme-icon theme-icon-timeshift disabled":""},{className:e[t].favorite?"theme-icon theme-icon-favorite-active active":""}]),c.push(i);return c}function Z(e){S.getChannels(B.config,function(t,i){t||(s.setData({data:J(i),focusIndex:0}),B.list=i,q.innerText=i.length,setTimeout(function(){$.pages.epg.setChannels(i)},0),e&&e(),s.$focusItem?s.$focusItem.data.value.getEpg(null,pe):pe(!1,[]))})}function Q(e){var t=++B.currentIndex,i=!0,n=!0;void 0!==(e=e||{}).osd&&(n=e.osd),void 0!==e.skipCensored&&(i=e.skipCensored),t>B.list.length-1&&(t=0,B.currentIndex=0),i&&(B.list[t].censored||B.list[t].genre&&B.list[t].genre.censored)?Q():xe(t,{osd:n})}function X(e){var t=--B.currentIndex,i=!0,n=!0;void 0!==(e=e||{}).osd&&(n=e.osd),void 0!==e.skipCensored&&(i=e.skipCensored),t<0&&(t=B.currentIndex=B.list.length-1),i&&(B.list[t].censored||B.list[t].genre&&B.list[t].genre.censored)?X(e):xe(t,{osd:n})}function ee(){var e;(s.$focusItem.data.value.pvr||s.$focusItem.data.value.local_pvr)&&(((e=s.$focusItem.data.value).censored||e.genre&&e.genre.censored)&&core.accessControl&&!core.accessControl.state?(U([$.intents.osdInput,$.intents.osdTv]),$.intents.osdInput=$.intents.osdTv=null,core.accessControl.request(function(t){t||core.intent({action:"record",data:{uri:e.url,name:e.name,id:e.id,pvr:{server:e.pvr,local:e.local_pvr}}})})):core.intent({action:"record",data:{uri:e.url,name:e.name,id:e.id,pvr:{server:e.pvr,local:e.local_pvr}}}))}function te(){var e=s.$focusItem.data.value,t=o.$focusItem.data.value;$.foreground=!1,core.intent({action:"record",data:{uri:e.url,name:e.name,epgName:e.name,startTime:t.start,endTime:t.end,id:e.id,pvr:{server:e.pvr,local:e.local_pvr}}})}function ie(){$.provider.antennaPower=!G}function ne(e,t,i){F=!0,clearTimeout(R),R=setTimeout(function(){F=!1},A),$.intents.osdInput=core.intent({action:"osd-input",data:{type:"numbers",length:4,startChar:e},events:{done:function(e){var n,a;if(!(e&&B.current&&B.current.number&&B.current.number===Number(e))){for(a=0;a<B.list.length;a++)if(B.list[a].number===Number(e)){n=a;break}void 0!==n?(s.focusIndex(n),xe(n,{osd:t,silent:!0,compareState:i}),s.$focusItem.data.value.getEpg(null,function(e,t){pe(e,t),se()})):core.notify({title:gettext("No such channel number"),icon:"alert",type:"warning",timeout:1e3}),F=!1}}}})}function ae(e,t){var i=B.list[e];s.focusIndex(e),i.getEpg(null,function(n,a){var s,c,l;if(pe(n,a),a.length){for(s=0;s<B.epg.list.length;s++)B.epg.list[s].id===t.id&&(c=s);for(l=0;l<o.data.length;l++)o.data[l]&&o.data[l].value&&o.data[l].value.id&&o.data[l].value.id===t.id&&o.focusIndex(l);c?(B.epg.currentPlayIndex=c,B.epg.currentPlayIndex=c,t.getLink(function(i,n){var a,s;n&&n.url?(B.epg.list[B.epg.currentPlayIndex-1]&&B.epg.list[B.epg.currentPlayIndex-1].archive&&(s=function(){o.emit("keydown",{code:D.up}),ae(e,B.epg.list[--B.epg.currentPlayIndex])}),a=B.epg.list[B.epg.currentPlayIndex+1]&&B.epg.list[B.epg.currentPlayIndex+1].archive?function(){o.emit("keydown",{code:D.down}),ae(e,B.epg.list[++B.epg.currentPlayIndex])}:function(){xe(e,{force:!0})},B.current=null,$.lastIntent=core.intent({action:"play",mime:"content/video",context:null,data:{uri:n.url,solution:n.solution,resource:"tv-archive",title:t.title,persistent:!0,mediaId:n["media_id"],exitWithConfirm:!0},events:{close:function(){B.context=null,$.intents.osdTv&&($.intents.osdTv.close(),$.intents.osdTv=null)},next:a,prev:s,nextChannel:Q,prevChannel:X,stop:function(t){(t=t||{}).manual&&xe(e,{force:!0})},onPip:function(){W=!0,B.context=null,B.current=null,B.currentIndex=null},end:a}},function(t,i){B.context=i,B.currentIndex=e,B.current=B.list[e]})):Ne(gettext("Error getting EPG"))})):Ne(gettext("Error getting EPG"))}else Ne(gettext("Error getting EPG for ")+i.name)})}function se(){var e=new Date/1e3;x.activeComponent===o&&(!o.$focusItem||o.$focusItem&&!o.$focusItem.data.value?p.hide():o.$focusItem.data.value.archive?ye({left:{code:D.menu,action:ce},middle:[{title:gettext("Play"),code:D.f2,action:function(){ae(s.$focusItem.index,o.$focusItem.data.value)}}],label:{code:D.menu,title:gettext("Hold OK button to open Options menu"),action:ce}}):(o.$focusItem.data.value.start>e||o.$focusItem.data.value.start<e&&o.$focusItem.data.value.end>e)&&s.$focusItem&&s.$focusItem.data&&s.$focusItem.value&&(s.$focusItem.data.value.pvr||s.$focusItem.data.value.local_pvr)?ye({left:{code:D.menu,action:ce},middle:[{title:gettext("Record"),code:D.f1,action:function(){o.$focusItem&&te()}}],label:{code:D.menu,title:gettext("Hold OK button to open Options menu"),action:ce}}):p.hide())}function oe(){var e={left:{code:D.menu,action:function(){a.blur(),fe(),m.show()}},middle:[],label:{code:D.menu,title:gettext("Hold OK button to open Options menu"),action:function(){a.blur(),fe(),m.show()}}};s.$focusItem&&(s.$focusItem.data.value.pvr||s.$focusItem.data.value.local_pvr)&&e.middle.push({code:D.f1,title:gettext("Record"),action:function(){ee()}}),e.middle.push({code:D.f2,title:G?gettext("Antenna power off"):gettext("Antenna power on"),action:function(){ie()}}),s.$focusItem&&(e.middle.push({code:D.f3,title:gettext("Favorite"),action:function(){ve({index:s.$focusItem.index,item:s.$focusItem},function(){})}}),e.middle.push({code:D.f4,title:gettext("TV guide"),action:function(){$.route($.pages.epg,s.$focusItem)}})),ye(e)}function ce(){var e,t=f.children[0],i=new Date/1e3,n=[];if(o.$focusItem){if((e=o.$focusItem.data.value).archive)n[0]={items:Te(z.play,gettext("Play")),click:function(){ae(s.$focusItem.index,o.$focusItem.data.value),f.hide()}};else{if(!(e.start>i||e.start<i&&e.end>i)||!s.$focusItem.data.value.pvr&&!s.$focusItem.data.value.local_pvr)return;n[0]={items:Te(z.record,gettext("Record")),click:function(){te(),f.hide()}}}t.init({data:n,size:n.length,focusIndex:0}),f.show()}}function le(e){core.notify({title:b(window.ngettext("{0} channel was deleted","{0} channels were deleted",e.data.length),e.data.length),icon:"alert",type:"warning",timeout:Y}),he()}function re(e){e.data.length>1?core.notify({title:b(gettext("{0} channels were added"),e.data.length),icon:"info",type:"success",timeout:Y}):1===e.data.length&&core.notify({title:b(gettext("Channel {0} was added"),e.data[0].name),icon:"info",type:"success",timeout:Y}),he()}function de(){core.applicationState.visible&&core.notify({title:gettext("Channels were updated"),icon:"info",type:"success",timeout:Y}),he()}function ue(){S.getChannels(B.config,function(e,t){var i;for(B.list=t,s.data=J(t),i=0;i<s.$body.children.length;i++)s.renderItem(s.$body.children[i],s.data[s.$body.children[i].index])})}function he(){S.getChannels(B.config,function(e,t){var i,n,a,o=s.$focusItem.data.value.id;if(s.setData({data:J(t),focusIndex:0}),B.list=t,q.innerText=t.length,$.pages.epg.setChannels(t),B.current&&B.current.id)for(i=0;i<B.list.length;i++)if(B.list[i].id===B.current.id){n=i;break}for(i=0;i<B.list.length;i++)if(B.list[i].id===o){a=i;break}n=n||0,a=a||0,B.currentIndex=n,s.focusIndex(a),B.list[s.$focusItem.index].getEpg(null,pe)})}function me(){function e(){var e,t=[];for(e=0;e<s.$body.children.length;e++)s.$body.children[e].data&&t.push(s.$body.children[e].data.value);S.getChannelsEpg({channels:t},function(t,i){var n;if(!t){for(e=0;e<s.$body.children.length;e++)s.$body.children[e].data&&(n=s.$body.children[e].data.value),n&&i[n.id]&&(n.currentEpg=i[n.id][0]);for(s.data=J(B.list),e=0;e<s.$body.children.length;e++)s.$body.children[e].data&&s.renderItem(s.$body.children[e],s.data[s.$body.children[e].index])}})}clearTimeout(B.channelListEpgTimeout),B.channelListEpgTimeout=setTimeout(e,core.environment.onFocusDebounceTimeout||400),clearInterval(B.channelListEpgInterval),B.channelListEpgInterval=setInterval(e,H)}function pe(e,t){var i,n,a,c,l,r,d,u="",h="",m=[],p=new Date/1e3;if(s.$focusItem){if(B.epg.list=t,(l=s.$focusItem.data.value)&&(l.censored||l.genre&&l.genre.censored)&&(!B.current||B.current.id!==l.id)&&core.accessControl&&!core.accessControl.state)return o.init({data:[]}),void o.$noData.classList.remove("disabled");for(o.$noData.classList.add("disabled"),t=function(e){var t,i,n,a=e.length,s=[];if(!e||0===a)return[];for(s.push({systemDate:!0,title:I.getCurrentDate(1e3*e[0].start)}),n=0;n<a-1;n++)t=e[n],i=e[n+1],s.push(t),(new Date(1e3*t.start).getDate()<new Date(1e3*i.start).getDate()||new Date(1e3*t.start).getMonth()<new Date(1e3*i.start).getMonth())&&s.push({systemDate:!0,title:I.getCurrentDate(1e3*i.start)});return s.push(e[a-1]),s}(t),a=0;a<t.length;a++)c="time",(i=t[a]).systemDate?m.push({items:[{value:i.title,className:"system-date"}],value:null}):(i.start&&(u=("0"+(u=new Date(1e3*i.start)).getHours()).slice(-2)+":"+("0"+u.getMinutes()).slice(-2)),i.archive?c+=" green":(s.$focusItem.data.value.pvr||s.$focusItem.data.value.local_pvr)&&(i.start>p||i.start<p&&i.end>p)&&(c+=" red"),h=i.end<p?" theme-text-disabled":i.start<p&&i.end>p?" current":" coming",m.push({items:[{className:c+h,value:u},{className:"title"+h,value:i.title}],value:i}));n={data:m,size:7},t.length&&(n.focusIndex=0),o.init(n),(d=t.findIndex(function(e){return!e.systemDate&&e.start<p&&e.end>p}))&&d>6&&(t.length-d-4>0?o.renderView(d-3):o.renderView(t.length-7)),(r=o.data.findIndex(function(e){return e.value&&e.value.start<p&&e.value.end>p}))&&r>0?o.focusIndex(r):o.$focusItem&&!o.$focusItem.data.value&&(o.data[o.$focusItem.index+1]?o.focusIndex(o.$focusItem.index+1):o.data[o.$focusItem.index-1]&&o.focusIndex(o.$focusItem.index-1)),o.$focusItem&&o.$focusItem.data.value&&V.innerText!==I.getCurrentDate(1e3*o.$focusItem.data.value.start)&&(V.innerText=I.getCurrentDate(1e3*o.$focusItem.data.value.start))}else V.innerText=I.getCurrentDate()}function fe(){var e=[],t=s.$focusItem.data.value;s.$focusItem&&(s.$focusItem.data.value.pvr||s.$focusItem.data.value.local_pvr)&&e.push({items:Te(z.record,gettext("Record")),click:function(){ee(),m.hide()}}),e.push({items:Te("theme-icon theme-icon-rc-f2",G?gettext("Antenna power off"):gettext("Antenna power on")),click:function(){ie(),m.hide()}}),t.favorite?e.push({items:Te(z.favoriteActive,gettext("Remove from favorites")),click:function(){ve({index:s.$focusItem.index,item:s.$focusItem},function(){m.hide()})}}):e.push({items:Te(z.favorite,gettext("Add to favorite")),click:function(){ve({index:s.$focusItem.index,item:s.$focusItem},function(){m.hide()})}}),e.push({items:Te(z.tvGuide,gettext("TV guide")),click:function(){m.hide(),setTimeout(function(){$.route($.pages.epg,s.$focusItem)})}}),S.local||(e=e.concat([])),v.init({data:e,size:e.length>5?5:e.length,focusIndex:0})}function ve(e,t){var i=e.index;B.list[i].toggleFavorite(function(n,a){n||(s.data[i].value.favorite=a,s.data[i].items[4].className=a?"icon theme-icon-favorite-active active":"icon theme-icon-favorite disabled",e.item&&s.renderItem(e.item,J([B.list[i]])[0]),B.current&&B.current.id===B.list[i].id&&M.set(B.list[i]),t&&t())})}function ge(e,t,i){var n=c.$body.children[1].children[0].children[0],a=(c.$body.children[2].children[0].children[1],c.$body.children[2].children[0].children[0],c.$body.children[0].children[0].children[1]),o=c.$body.children[0].children[0].children[0];e=e||{},(B.config.search||B.config.favorite||B.config.genre||Object.keys(e).length)&&(e.favorite?n.className="theme-icon theme-icon-favorite-active active":n.className="theme-icon theme-icon-favorite",B.config.favorite=e.favorite||!1,a.innerText=e.search||gettext("Search"),B.config.search=e.search||!1,B.config.search?o.classList.add("active"):o.classList.remove("active"),Z(i),t&&(B.lastActiveState.config={favorite:!1,byName:!1,genre:!1,search:!1},s.focusIndex(B.list.indexOf(B.current))))}function ye(e,t){t=t||core.environment.onFocusDebounceTimeout||400,e=e||{middle:[]},clearTimeout(B.footerInitDelay),B.footerInitDelay=setTimeout(function(){p.init(e),e&&p.show()},t)}function xe(e,t){var i;if(t=t||{},i=B.list[e],t.osd&&Ie(i,!1),i.censored||i.genre.censored){if(null!==B.current&&i.id===B.current.id&&!t.force)return void n();U([$.intents.osdInput,$.intents.osdTv]),$.intents.osdInput=$.intents.osdTv=null,core.accessControl.request(function(e){e||n({forceEpg:!0})})}else n();function n(n){n=n||{},i["monitoring_status"]?i.getUrl(function(a,o){a?core.notify({title:"Error getting channel link",icon:"alert",type:"warning",timeout:2e3}):function(i,a,o){var c,l,r=B.current===i&&!t.force;r&&(a="");if($.foreground=!r,r)return void ke({force:!0});c=void 0!==t.context?t.context:B.context;(i.pvr||i.local_pvr)&&(l=[{icon:"f1",title:"Record",handler:function(){s.focusIndex(B.currentIndex),$.intents.osdTv&&($.intents.osdTv.close(),$.intents.osdTv=null),ee()}}]);$.lastIntent=core.intent({action:"play",mime:"content/video",silent:t.silent,data:{uri:a,title:i.name,solution:o||"auto",headless:!0,persistent:!0,modalMenu:l,mediaId:i.id,tvChannel:i,viewport:void 0,extra:i.extra,exitWithConfirm:!0,retryOnError:!0,stream:!0,volumeCorrection:i["volume_correction"]},context:c,events:be(i,e)},function(e,t){B.context=t}),B.current=i,B.currentIndex=e,n.forceEpg&&s.$focusItem&&s.$focusItem.data.value.getEpg(null,pe)}(i,o.url,o.solution)}):core.notify({title:gettext("Channel is temporary unavailable"),icon:"alert",type:"warning",timeout:2e3}),M.set(i)}t.compareState&&(B.config.favorite===B.lastActiveState.config.favorite&&B.config.genre===B.lastActiveState.config.genre&&B.config.search===B.lastActiveState.config.search&&B.config.byName===B.lastActiveState.config.byName||(B.lastActiveState.config.favorite=B.config.favorite,B.lastActiveState.config.genre=B.config.genre,B.lastActiveState.config.search=B.config.search,B.lastActiveState.config.byName=B.config.byName)),W&&(W=!1)}function $e(e){[48,49,50,51,52,53,54,55,56,57].indexOf((e=e||{}).code)>-1&&ne(String.fromCharCode(e.code),!1,!0)}function be(e,t){return{nextChannel:B.list.length>1&&Q,prevChannel:B.list.length>1&&X,onInfoPress:function(){Ie(e,!0)},close:function(){s.focusIndex(B.currentIndex),B.context=null,$.lastIntent.silent=!1,clearTimeout(B.epgTimeout),s.$focusItem&&(B.epgTimeout=setTimeout(function(){s.$focusItem&&B.list[s.$focusItem.index].getEpg(null,pe)},800),$.intents.osdTv&&($.intents.osdTv.close(),$.intents.osdTv=null))},onNumberPress:function(e){ne(e.number,!0)},start:function(){clearTimeout(B.lastChannelTimeout),B.lastChannelTimeout=setTimeout(function(){B.list[t].setLast()},K)},onPip:function(){W=!0,B.context=null,B.current=null,B.currentIndex=null}}}function Ie(e,t){$.intents.osdTv=core.intent({action:"osd-tv",data:{name:e.name,number:e.number,favorite:e.favorite,pvr:e.local_pvr||e.pvr,timeshift:e.local_timeshift,censored:e.censored||e.genre&&e.genre.censored,attach:t}},function(){})}function we(){return B.config.favorite!==B.lastActiveState.config.favorite||B.config.genre!==B.lastActiveState.config.genre||B.config.search!==B.lastActiveState.config.search||B.config.byName!==B.lastActiveState.config.byName}function ke(e){if(!B.current||void 0===B.currentIndex)return a.blur(),void g.show();e=e||{},we()&&!e.force?core.notify({title:gettext("Reset filters")+" ?",icon:"alert",buttons:[{value:gettext("Cancel"),click:function(){}},{value:gettext("Reset filters").split(" ")[0],click:function(){ge(B.lastActiveState.config),B.config.favorite=B.lastActiveState.config.favorite,B.config.genre=B.lastActiveState.config.genre,B.config.search=B.lastActiveState.config.search,B.config.byName=B.lastActiveState.config.byName,$.lastIntent.show($.lastIntent.receiver),$.foreground=!1}}],timeout:5e3}):($.lastIntent.show($.lastIntent.receiver),$.foreground=!1)}function Ce(){$.lastIntent&&$.lastIntent.emit("exit"),$.intents.osdTv&&($.intents.osdTv.close(),$.intents.osdTv=null),S.removeListener("channels:delete",le),S.removeListener("channels:add",re),S.removeListener("channels:modified",ue),S.removeListener("update",de),S.stopBackgroundCheck(),g.hide(),S.destroy&&S.destroy()}function Te(e,t){return[{className:e},{value:t}]}function Ne(e,t){t=t||3e3,core.notify({title:e,icon:"alert",type:"warning",timeout:t})}$.foreground=!0,$.provider.addListener("scanning:stop",function(){Z()}),$.provider.addListener("channels:update",function(){Z()}),$.provider.addListener("epg:update",function(){s.$focusItem&&s.$focusItem.data.value.getEpg(null,pe)}),$.provider.addListener("antennaPower",function(e){G=e,oe(),fe(),c.$body.children[2].children[0].children[0].className="theme-icon "+(G?"theme-icon-dvb-power-on":"theme-icon-dvb-power-off")}),core.addListener("close",Ce),core.addListener("exit",Ce),core.addListener("hide",function(e){e.source===core.SOURCES.INTENT&&e.data&&e.data.intent&&"play"===e.data.intent.action?$.foreground=!1:($.lastIntent&&$.lastIntent.emit("exit"),we()&&(ge(B.lastActiveState.config),B.config.favorite=B.lastActiveState.config.favorite,B.config.genre=B.lastActiveState.config.genre,B.config.search=B.lastActiveState.config.search,B.config.byName=B.lastActiveState.config.byName))}),core.addListener("show",function(e){var t=$.foreground,i=$.foreground?B.context:null;if(e.source===core.SOURCES.INTENT&&e.data&&e.data.intent&&"play"===e.data.intent.action||e.source===core.SOURCES.SYSTEM&&e.data&&e.data.intent&&"record"!==e.data.intent.action){if($.foreground=!0,$.intents.osdTv&&($.intents.osdTv.close(),$.intents.osdTv=null),s.focusIndex(B.currentIndex),me(),clearTimeout(B.epgTimeout),!s.$focusItem)return;B.epgTimeout=setTimeout(function(){s.$focusItem&&B.list[s.$focusItem.index].getEpg(null,function(e,t){pe(e,t),se()})},800)}else!B.list[B.currentIndex]||B.list[B.currentIndex].censored||B.list[B.currentIndex].genre&&B.list[B.currentIndex].genre.censored?(B.currentIndex=null,B.current=null):xe(B.currentIndex,{silent:t,context:i,force:!0})}),x.add(u=new N({visible:!1,title:gettext("Categories"),className:"categoryList",events:{show:function(){this.focus(),this.children[0].focus(),setTimeout(function(){p.hide()},0)},hide:function(){l.focus()}},children:[new C({size:5,cycle:!0,scroll:P.categoryList,className:"padded",events:{"click:item":function(e){var t=c.$body.children[2].children[0].children[0];u.hide(),B.config.genre=e.$item.data.value.id,l.children[0].$focusItem.layout.$node.children[1].innerText=e.$item.data.value.name,e.$item.index?t.classList.add("active"):t.classList.remove("active"),Z(function(){l.focus()})},keydown:function(e){switch(C.prototype.defaultEvents.keydown.call(this,e),e.code){case D.back:case D.menu:u.hide(),e.stop=!0;break;case D.f1:e.stop=!0}}}})]}),h=new N({visible:!1,title:gettext("Sort"),events:{show:function(){this.focus(),this.children[0].focus(),p.hide()},hide:function(){l.focus()}},children:[new T({focusIndex:0,size:2,cycle:!0,data:[{state:!0,title:gettext("By number"),value:!1},{state:!1,title:gettext("By name"),value:!0}],events:{select:function(e){l.children[0].$focusItem.layout.$node.children[1].innerText=e.data.title,B.config.byName=e.data.value,Z()},"click:item":function(){h.hide(),l.focus()},keydown:function(e){switch(C.prototype.defaultEvents.keydown.call(this,e),e.code){case D.back:case D.menu:h.hide(),e.stop=!0;break;case D.f1:e.stop=!0}}}})]})),x.once("show",function(){$.pages.epg.addListener("channel:click",function(e){xe(e.channelIndex)}),$.pages.epg.addListener("epg:click",ae)}),(p=new L({parent:x,data:{middle:[]}})).show(),(n=[{name:"search",items:[{className:"theme-icon theme-icon-search",name:"$icon"},{value:gettext("Search"),name:"$text"}],click:function(){core.intent({action:"keyboard",data:{type:"text",icon:null,title:gettext("TV channel search"),value:B.config.search},events:{done:function(e){e.value&&B.config.search!==e.value?(B.config.search=e.value,c.links.search.links.$text.innerText=e.value,c.links.search.links.$icon.classList.add("active"),Z()):e.value&&e.value.trim()||(c.links.search.links.$text.innerText=gettext("Search"),c.links.search.links.$icon.classList.remove("active"),B.config.search!==e.value&&(B.config.search=e.value,Z()))}}})}},{name:"favorite",items:[{className:"theme-icon theme-icon-favorite",name:"$icon"},{value:gettext("Favorite"),name:"$text"}],click:function(){B.config.favorite?c.links.favorite.links.$icon.className="theme-icon theme-icon-favorite":c.links.favorite.links.$icon.className="theme-icon theme-icon-favorite-active active",B.config.favorite=!B.config.favorite,Z()}},{name:"sort",items:[{className:"theme-icon theme-icon-sort-az",name:"$icon"},{value:gettext("By number"),className:"theme-item-more",name:"$text"}],click:function(){a.blur(),h.show()}},{items:[{className:"theme-icon theme-icon-exit"},{value:gettext("Exit")}],click:function(){a.blur(),g.show()}}]).splice(2,0,{name:"categories",items:[{className:"theme-icon theme-icon-categories",name:"$icon"},{value:gettext("All categories"),className:"theme-item-more",name:"$text"}],click:function(){l.blur(),u.show(),setTimeout(function(){u.show()},50)}}),n.splice(2,0,{items:[{className:"theme-icon "+(G?"theme-icon-dvb-power-on":"theme-icon-dvb-power-off")},{value:gettext("Scan DVB channels"),className:"theme-item-more"}],click:function(){$.route($.pages.scanOptions)}}),_.className="amountContainer",q.className="amount",q.innerText=0,_.appendChild(q),V.id="currentDate",O=[l=new k({title:gettext("Menu"),events:{focus:function(e){k.prototype.defaultEvents.focus.call(this,e),ye({middle:[{code:D.f1,title:gettext("Reset filters"),action:function(){ge(null,!0)}}],left:{code:D.menu,action:function(){y.show()}}}),p.show()}},children:[c=new C({focusIndex:0,cycle:!0,data:n,size:n.length})]})],c.addListener("keydown",$e),O=O.concat([r=new k({title:[{value:gettext("Channel list"),className:"name"},_],main:!0,className:"channelPanel",events:{focus:function(e){k.prototype.defaultEvents.focus.call(this,e),oe()}}}),d=new k({title:[gettext("TV program"),V],children:[o=new C({size:7,className:"programList",noData:j,scroll:P.epg,events:{keydown:function(e){var t,i=o.$focusItem;switch(e.code){case D.up:t=o.data[i.index-1],i.index>0&&t&&t.value?C.prototype.defaultEvents.keydown.call(this,e):o.data[i.index-2]&&o.focusIndex(i.index-2),o.$focusItem&&o.$focusItem.data.value&&o.$focusItem&&o.$focusItem.data&&o.$focusItem.data.value&&V.innerText!==I.getCurrentDate(1e3*o.$focusItem.data.value.start)&&(V.innerText=I.getCurrentDate(1e3*o.$focusItem.data.value.start)),se();break;case D.down:(t=o.data[i.index+1])&&t.value?C.prototype.defaultEvents.keydown.call(this,e):t&&!t.value&&o.data[i.index+2]&&o.focusIndex(i.index+2),se(),o.$focusItem&&o.$focusItem.data.value&&V.innerText!==I.getCurrentDate(1e3*o.$focusItem.data.value.start)&&(V.innerText=I.getCurrentDate(1e3*o.$focusItem.data.value.start));break;default:C.prototype.defaultEvents.keydown.call(this,e)}$e(e)},"click:item":function(e){var t;e&&e.$item&&e.$item.value&&((t=e.$item.value).archive?ae(s.$focusItem.index,t):(t.channel.local_pvr||t.channel.pvr)&&te())}}})],events:{focus:function(e){k.prototype.defaultEvents.focus.call(this,e),se()}}})]),a=new w({panels:O}),x.add(a),r.$body.appendChild(P.channelList.$node),u.$body.appendChild(P.categoryList.$node),d.$body.appendChild(P.epg.$node),o.$noData.classList.add("disabled"),r.add(s=new C({size:7,focusIndex:0,cycle:!0,noData:gettext("No channels"),data:[],render:i(43),fixedData:!0,className:"channelList",scroll:P.channelList,events:{keydown:function(e){var t=I.getCurrentDate(),i=this;if(!F){switch(C.prototype.defaultEvents.keydown.call(this,e),e.code){case D.up:case D.down:if(V.innerText!==t&&(V.innerText=t),oe(),clearTimeout(B.epgTimeout),!i.$focusItem)return;B.epgTimeout=setTimeout(function(){i.$focusItem&&B.list[i.$focusItem.index].getEpg(null,function(e,t){pe(e,t),$.activePage.activeComponent===o&&se()})},800);break;case D.menu:}$e(e)}},"click:item":function(e){xe(e.$item.index,{compareState:!0,silent:W})},"focus:item":function(){1===a.focusIndex&&oe()},"move:view":me}})),x.add(m=new N({title:gettext("Actions"),className:"width2x",events:{show:function(){this.focus(),this.children[0].focus(),p.hide()},hide:function(){r.focus(),p.show()}},children:[v=new C({className:"actionsModal",size:2,cycle:!0,focusIndex:0,data:[{items:Te(z.record,gettext("Record")),click:function(){ee(),m.hide()}},{items:Te("theme-icon theme-icon-rc-f2",G?gettext("Antenna power off"):gettext("Antenna power on")),click:function(){ie(),m.hide()}},{items:Te(z.favorite,gettext("Favorite")),click:function(){ve({index:s.$focusItem.index,item:s.$focusItem},function(){m.hide()})}},{items:Te(z.tvGuide,gettext("TV guide")),click:function(){$.route($.pages.epg,s.$focusItem)}}],events:{keydown:function(e){switch(C.prototype.defaultEvents.keydown.call(this,e),e.code){case D.back:case D.menu:m.hide(),e.stop=!0}}}})]}),f=new N({title:gettext("Actions"),events:{show:function(){this.focus(),this.children[0].focus(),p.hide()},hide:function(){o.focus(),p.show()}},children:[new C({data:[],size:1,cycle:!0,events:{keydown:function(e){switch(C.prototype.defaultEvents.keydown.call(this,e),e.code){case D.back:case D.menu:f.hide(),e.stop=!0}}}})]}),g=new N({title:gettext("Exit"),events:{show:function(){this.focus(),this.children[0].focus(),p.hide()},hide:function(){a.focus(),p.show()}},children:[new C({className:"padded",focusIndex:0,data:[{items:[{value:gettext("Yes")}],click:function(){g.hide(),$.exit()}},{items:[{value:gettext("No")}],click:function(){g.hide()}}],size:2,cycle:!0,events:{keydown:function(e){switch(C.prototype.defaultEvents.keydown.call(this,e),e.code){case D.back:case D.menu:g.hide(),e.stop=!0}}}})]}),y=new N({title:gettext("Actions"),events:{show:function(){this.children[0].focus(),p.hide()},hide:function(){a.focus(),p.show()}},children:[new C({focusIndex:0,data:[{items:Te("theme-icon theme-icon-rc-f1",gettext("Reset filters")),click:function(){ge(),y.hide()}}],size:1,cycle:!0,events:{keydown:function(e){switch(C.prototype.defaultEvents.keydown.call(this,e),e.code){case D.back:case D.menu:y.hide(),e.stop=!0}}}})]})),x.addListener("show",function(e){r.focus(),e&&e.data&&s.focusIndex(e.data.index)}),x.addListener("keydown",function(e){if(!F)switch(e.code){case D.back:ke();break;case D.exit:$.lastIntent&&$.lastIntent.emit("exit"),$.minimized=!0;break;case D.web:$.minimized=!0;break;case D.channelNext:case D.channelPrev:}}),function(){var e=core.applicationState.home;V.innerText=I.getCurrentDate(),V.style.height=window.getComputedStyle(V).height,S.updateChannelsList(function(t){S.getLastChannelId(function(t,i){var n,a;setTimeout(function(){$.ready(),$.loaded=!0,$.emit("ready"),S.startBackgroundCheck&&S.startBackgroundCheck()},100),Z(t&&!i?function(){s.$focusItem}:function(){for(n=0;n<B.list.length;n++)if(B.list[n].id===Number(i)){a=n;break}a=a||0,0!==B.list.length&&(s.focusIndex(a),s.$focusItem.data.value&&(s.$focusItem.data.value.censored||s.$focusItem.data.value.genre&&s.$focusItem.data.value.genre.censored)||core.once("show",function(){core.applicationState.visible&&xe(a,e?{silent:!1,context:null}:{silent:!1})}))})})}),0;S.addListener("channels:delete",le),S.addListener("channels:add",re),S.addListener("channels:modified",ue),S.addListener("update",de)}(),core.addListener("play:channel",function(e){var t,i;function n(e){for(t=0;t<B.list.length;t++)if(B.list[t].number===e){i=t;break}void 0!==i&&(B.list[i].censored||!B.list[i].genre||B.list[i].censored||(xe(i),s.focusIndex(i),$.lastIntent.show($.lastIntent.receiver)))}function a(e){$.loaded?n(e):$.once("ready",function(){n(e)})}B.config.favorite||B.config.byName||B.config.genre||B.config.search?ge(!1,!1,function(){a(e.number)}):a(e.number)}),e.exports=x},function(e,t,i){"use strict";e.exports=function(e){var t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,function(e,i){return void 0===t[i]?e:t[i]})}},function(e,t,i){"use strict";var n={},a=[gettext("January"),gettext("February"),gettext("March"),gettext("April"),gettext("May"),gettext("June"),gettext("July"),gettext("August"),gettext("September"),gettext("October"),gettext("November"),gettext("December")];n.getCurrentDate=function(e){var t,i=new Date;return e&&(i=new Date(e)),t=a[i.getMonth()],"en"===core.environment.language?t+" "+i.getDate():i.getDate()+" "+t},e.exports=n},function(e,t,i){"use strict";e.exports={record:"theme-icon theme-icon-rc-f1",play:"theme-icon theme-icon-rc-f2",favorite:"theme-icon theme-icon-rc-f3",favoriteActive:"theme-icon theme-icon-rc-f3",tvGuide:"theme-icon theme-icon-rc-f4"}},function(e,t,i){"use strict";var n,a=document.getElementById("titleWidget"),s={},o=document.getElementById("titleWidgetNumber"),c=document.getElementById("titleWidgetName"),l=document.getElementById("icon-favorite"),r=document.getElementById("titleWidgetTime");function d(){var e=new Date;r.innerText=("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2)}s.set=function(e){e=e||{},c.innerText=e.name||"",o.innerText=e.number||"",e.favorite?l.classList.remove("hidden"):l.classList.add("hidden"),e.epg&&(c.innerText+="\n"+e.epg)},s.display=function(e,t){t=t||5e3,s.visible||s.show(),e.background&&a.classList.add("bg"),clearTimeout(n),n=setTimeout(function(){e.background},t)},d(),setInterval(d,35e3),e.exports=s},function(e,t,i){"use strict";var n=i(5);e.exports=function(e,t){var i,a,s,o,c,l;if(e.ready)for(c=0;c<t.items.length;c++)"string"==typeof(s=t.items[c]).value||void 0===s.value?((a=e.layout.$node.childNodes[c]).innerText=s.value||"",a.className=s.className||""):s.htmlInstance&&(a=e.layout.$node.childNodes[c],e.domLinks.$title.innerText=s.realValue.name,e.domLinks.$epg.innerText=s.realValue.epg||"");else{for(;e.firstChild;)e.removeChild(e.firstChild);l={focusable:!1,data:t.items},t.className&&(l.className=t.className),i=new n(l),o=t.items[1].value,e.domLinks={$title:o.firstChild,$epg:o.firstChild.nextSibling},e.appendChild(i.$node),e.layout=i,i.parent=this,i.$parentItem=e,i.addListener("click",function(){this.parent.emit("click:item",{$item:e,inner:!0})}),t.click&&(this.handlers[e.index]=t.click),e.ready=!0}e.value=t.value||{}}},function(e,t,i){"use strict";var n,a,s,o,c,l,r,d,u,h,m,p,f,v,g=i(7),y=i(6),x=new g({$node:document.getElementById("pageScanOptions")}),$=i(17),b=i(18),I=i(4),w=i(9),k=i(19),C=i(11),T=i(0),N=i(12),E=i(8),L=i(45),S=new N,D=870,P=7200,z=6875,O={start:5e4,end:858e3,step:500},F={manual:!1,more:!1,currentType:{},symbolRate:6850,modulation:0,frequencyStart:5e4,frequencyEnd:858e3,frequency:5e4,bandwidth:8,network:""},A={name:"scanType",items:[{name:"$name",className:"name theme-subhead-color",value:gettext("Scanning type")+":"},{name:"$text",className:"text",value:gettext("Auto")}],className:"theme-item-more",click:function(){x.panelSet.blur(),x.modalScan.show(),x.modalScan.focus()}},R={name:"type",items:[{name:"$name",className:"name theme-subhead-color",value:gettext("DVB type")+":"},n={name:"$text",className:"text",value:""}],className:"theme-item-more",click:function(){x.panelSet.blur(),x.modalTypes.show(),x.modalTypes.focus()}},M={name:"symbolRate",items:[{name:"$name",className:"name theme-subhead-color",value:gettext("Symbol rate")+":"},a={name:"$text",className:"text",value:""+F.symbolRate}],className:"theme-item-more",click:function(){x.panelSet.blur(),x.modalSymbolRate.show(),x.modalSymbolRate.focus()}},B={name:"modulation",items:[{name:"$name",className:"name theme-subhead-color",value:gettext("Modulation")+":"},s={name:"$text",className:"text",value:gettext("Auto")}],className:"theme-item-more",click:function(){x.panelSet.blur(),x.modalModulation.show(),x.modalModulation.focus()}},q={items:[{className:"name theme-subhead-color",value:gettext("Scanning type")+":"},{className:"text",value:gettext("Manual")}],className:"theme-item-more",click:function(){x.panelSet.blur(),x.modalScan.show(),x.modalScan.focus()}},_={name:"frequencyStart",items:[{name:"$name",className:"name theme-subhead-color",value:gettext("Start frequency (KHz)")+":"},o={name:"$text",className:"text",value:""+F.frequencyStart}],className:"theme-item-more",click:function(){x.panelSet.blur(),x.modalFrequencyStart.show(),x.modalFrequencyStart.focus(),x.footer.hide()},manualEdit:!0,configValue:"frequencyStart"},V={name:"frequencyEnd",items:[{name:"$name",className:"name theme-subhead-color",value:gettext("End frequency (KHz)")+":"},c={name:"$text",className:"text",value:""+F.frequencyEnd}],className:"theme-item-more",click:function(){x.panelSet.blur(),x.modalFrequencyEnd.show(),x.modalFrequencyEnd.focus(),x.footer.hide()},manualEdit:!0,configValue:"frequencyEnd"},j={name:"bandwidth",items:[{name:"$name",className:"name theme-subhead-color",value:gettext("Bandwidth (MHz)")+":"},l={name:"$text",className:"text",value:F.bandwidth+""}],className:"theme-item-more",click:function(){x.panelSet.blur(),x.modalBand.show(),x.modalBand.focus()}},H={name:"frequency",items:[{name:"$name",className:"name theme-subhead-color",value:gettext("Frequency (KHz)")+":"},r={name:"$text",className:"text",value:""+F.frequency}],className:"theme-item-more",click:function(){x.panelSet.blur(),x.modalFrequency.show(),x.modalFrequency.focus(),x.footer.hide()},manualEdit:!0,configValue:"frequency"},G={name:"networkID",items:[{name:"$name",className:"name theme-subhead-color",value:gettext("Network ID")+":"},{name:"$text",className:"text",value:""+F.network}],className:"theme-item-more",click:function(){window.core.intent({action:"keyboard",data:{value:F.network,title:gettext("Network ID"),mode:"number"},events:{done:function(e){if(e.value)try{F.network=parseInt(e.value,10)}catch(t){e.stop=!0,window.core.notify({title:"Network ID is not correct",icon:"alert",type:"warning",timeout:5e3})}}}},function(e){})}},Y=[A,R,M,B],W=[q,R,_,V,j],K=[q,R,M,B,H,G];function U(){var e=v.$focusItem;core.intent({action:"keyboard",data:{mode:"number",icon:null,title:e.links.$name.innerText,value:e.links.$text.innerText},events:{done:function(t){var i;try{i=parseInt(t.value,10)}catch(e){core.notify({title:gettext("Value is incorrect"),icon:"alert",type:"error",timeout:3e3})}i>=O.start&&i<=O.end?(e.links.$text.innerText=i+"",F[e.data.configValue]=i):core.notify({title:gettext("Value is incorrect"),icon:"alert",type:"error",timeout:3e3})}}})}for(d=C.tag("div",{className:"amountContainer"},u=C.tag("div",{className:"amount"},"0")),x.modalScan=new w({visible:!1,title:gettext("Scanning types"),events:{show:function(){this.focus(),x.footer.hide()}},children:[new k({focusIndex:0,size:2,cycle:!0,data:[{state:!0,title:gettext("Auto"),value:!1},{state:!1,title:gettext("Manual"),value:!0}],events:{"click:item":function(){x.modalScan.hide(),x.middlePanel.focus()},keydown:function(e){k.prototype.defaultEvents.keydown.call(this,e),e.code===T.back&&(e.stop=!0,x.modalScan.hide(),x.middlePanel.focus())},select:function(e){F.manual=e.data.value,x.middlePanel.reset()}}})]}),x.add(x.modalScan),x.modalTypes=new w({visible:!1,title:gettext("DVB types"),events:{show:function(){var e,t=y.provider.types.current,i=0,n=[];for(e=0;e<t.length;e++)n.push({state:t[e].type===F.currentType.type,title:t[e].name,value:t[e]}),t[e].type===F.currentType.type&&(i=e);f.init({data:n,size:n.length,focusIndex:i}),this.focus()},hide:function(){x.panelSet.focus()}},children:[f=new k({cycle:!0,scroll:S,data:[],events:{"click:item":function(){x.modalTypes.hide(),x.middlePanel.focus()},keydown:function(e){k.prototype.defaultEvents.keydown.call(this,e),e.code===T.back&&(e.stop=!0,x.modalTypes.hide(),x.middlePanel.focus())},select:function(e){F.currentType=e.data.value,v.links.type.links.$text.innerText=F.currentType.name,n.value=F.currentType.name}}}),S]}),x.add(x.modalTypes),x.footer=new E({visible:!0,parent:x,data:[{code:T.f1,title:gettext("Manual correction"),action:U},{code:T.menu,action:function(){x.modalActions.show()}}]}),x.modalActions=new w({visible:!1,title:gettext("actions"),events:{show:function(){x.panelSet.blur(),this.focus()},hide:function(){x.panelSet.focus(),v.$focusItem.data.manualEdit&&x.footer.show()}},children:[new I({cycle:!0,size:1,focusIndex:0,data:[{items:[{className:"theme-icon theme-icon-rc-f1",value:""},{value:gettext("Manual correction")}],click:function(){U(),x.modalActions.hide()}}],events:{keydown:function(e){I.prototype.defaultEvents.keydown.call(this,e),e.code!==T.back&&e.code!==T.menu||(e.stop=!0,x.modalActions.hide())}}})]}),x.add(x.modalActions),h=[],m=D;m<=P;m++)h.push({state:m===z,value:m,title:m});for(p=z-D,x.modalSymbolRate=new w({visible:!1,title:gettext("Symbol rate"),children:[new k({cycle:!0,size:5,data:h,scroll:S=new N,focusIndex:p,events:{"click:item":function(){x.modalSymbolRate.hide(),x.middlePanel.focus()},keydown:function(e){k.prototype.defaultEvents.keydown.call(this,e),e.code===T.back&&(e.stop=!0,x.modalSymbolRate.hide(),x.middlePanel.focus())},select:function(e){F.symbolRate=e.data.value,v.links.symbolRate.links.$text.innerText=F.symbolRate,a.value=F.symbolRate+""}}}),S]}),x.add(x.modalSymbolRate),x.modalModulation=new w({visible:!1,title:gettext("Modulation"),children:[new k({cycle:!0,size:5,focusIndex:0,data:[{state:!0,value:0,title:gettext("Auto")},{value:1,title:"16 QAM"},{value:2,title:"32 QAM"},{value:3,title:"64 QAM"},{value:4,title:"128 QAM"},{value:5,title:"256 QAM"}],events:{"click:item":function(){x.modalModulation.hide(),x.middlePanel.focus()},keydown:function(e){k.prototype.defaultEvents.keydown.call(this,e),e.code===T.back&&(e.stop=!0,x.modalModulation.hide(),x.middlePanel.focus())},select:function(e){F.modulation=e.data.value,v.links.modulation.links.$text.innerText=e.data.title,s.value=e.data.title}}})]}),x.add(x.modalModulation),x.modalBand=new w({visible:!1,title:gettext("Modulation"),children:[new k({cycle:!0,size:3,focusIndex:2,data:[{value:6,title:"6"},{value:7,title:"7"},{value:8,title:"8",state:!0}],events:{"click:item":function(){x.modalBand.hide(),x.middlePanel.focus()},keydown:function(e){k.prototype.defaultEvents.keydown.call(this,e),e.code===T.back&&(e.stop=!0,x.modalBand.hide(),x.middlePanel.focus())},select:function(e){F.bandwidth=e.data.value,v.links.bandwidth.links.$text.innerText=e.data.title,l.value=e.data.title}}})]}),x.add(x.modalBand),h=[],m=O.start;m<=O.end;m+=O.step)h.push({state:m===F.frequencyStart,value:m,title:m});for(p=(F.frequencyStart-O.start)/O.step,x.modalFrequencyStart=new w({visible:!1,title:gettext("Start frequency (KHz)"),children:[new k({cycle:!0,size:5,data:h,scroll:S=new N,focusIndex:p,events:{"click:item":function(){x.footer.show(),x.modalFrequencyStart.hide(),x.middlePanel.focus()},keydown:function(e){k.prototype.defaultEvents.keydown.call(this,e),e.code===T.back&&(e.stop=!0,x.modalFrequencyStart.hide(),x.middlePanel.focus(),x.footer.show())},select:function(e){F.frequencyStart=e.data.value,v.links.frequencyStart.links.$text.innerText=F.frequencyStart,o.value=F.frequencyStart+""}}}),S]}),x.add(x.modalFrequencyStart),h=[],m=O.start;m<=O.end;m+=O.step)h.push({state:m===F.frequencyEnd,value:m,title:m});for(p=(F.frequencyEnd-O.start)/O.step,x.modalFrequencyEnd=new w({visible:!1,title:gettext("End frequency (KHz)"),children:[new k({cycle:!0,size:5,data:h,scroll:S=new N,focusIndex:p,events:{"click:item":function(){x.modalFrequencyEnd.hide(),x.middlePanel.focus(),x.footer.show()},keydown:function(e){k.prototype.defaultEvents.keydown.call(this,e),e.code===T.back&&(e.stop=!0,x.modalFrequencyEnd.hide(),x.middlePanel.focus(),x.footer.show())},select:function(e){F.frequencyEnd=e.data.value,v.links.frequencyEnd.links.$text.innerText=F.frequencyEnd,c.value=F.frequencyEnd+""}}}),S]}),x.add(x.modalFrequencyEnd),h=[],m=O.start;m<=O.end;m+=O.step)h.push({state:m===F.frequency,value:m,title:m});p=(F.frequency-O.start)/O.step,x.modalFrequency=new w({visible:!1,title:gettext("Frequency (KHz)"),children:[new k({cycle:!0,size:5,data:h,scroll:S=new N,focusIndex:p,events:{"click:item":function(){x.modalFrequency.hide(),x.middlePanel.focus(),x.footer.show()},keydown:function(e){k.prototype.defaultEvents.keydown.call(this,e),e.code===T.back&&(e.stop=!0,x.modalFrequency.hide(),x.middlePanel.focus(),x.footer.show())},select:function(e){F.frequency=e.data.value,v.links.frequency.links.$text.innerText=F.frequency,r.value=F.frequency+""}}}),S]}),x.add(x.modalFrequency),x.middlePanel=new b({title:[{value:gettext("Scan DVB channels"),className:"name"},d],main:!0,children:[],className:"middlePanel"}),x.middlePanel.scroll=new N,x.middlePanel.add(v=new I({cycle:!0,focusIndex:0,size:6,className:"padded",scroll:x.middlePanel.scroll,events:{overflow:function(){v.$focusItem.classList.remove("focus"),x.middlePanel.scroll.hide(),x.middlePanel.button.focus()},keydown:function(e){I.prototype.defaultEvents.keydown.call(this,e)},"focus:item":function(e){e.$curr.data.manualEdit?x.footer.show():x.footer.hide()}},data:[]}),x.middlePanel.scroll),x.middlePanel.add(x.middlePanel.button=new L({value:gettext("Start"),className:"bottom theme-footer",$node:x.middlePanel.$node.appendChild(document.createElement("div")),events:{click:function(){y.route(y.pages.scanning,F)},keydown:function(e){e.code===T.up?(v.focus(),x.middlePanel.scroll.show(),v.$focusItem.classList.add("focus"),v.focusIndex(v.data.length-1)):e.code===T.down?(v.focus(),x.middlePanel.scroll.show(),v.$focusItem.classList.add("focus"),v.focusIndex(0)):e.code===T.ok&&x.middlePanel.button.events["click"]&&x.middlePanel.button.emit("click",{event:e})}}})),x.panelSet=new $({visible:!0,$node:document.getElementById("panelSetInfo"),focusIndex:0,panels:[x.middlePanel]}),x.add(x.panelSet),x.middlePanel.reset=function(){var e,t=[],i=y.provider.types.current;for(F.more=y.provider.scanOptions.more,e=0;e<i.length;e++)if(i[e].type===F.currentType.type){F.currentType=i[e];break}F.currentType.type||(F.currentType=i[0]),n.value=F.currentType.name,t=F.manual?F.more?K:W:F.more?Y:Y.slice(0,2),u.innerText=t.length,v.setData({data:t,focusIndex:0})},x.addListener("keydown",function(e){switch(e.code){case T.back:y.route(y.pages.main),e.stop=!0}}),x.addListener("show",function(){x.middlePanel.reset(),x.panelSet.show(),x.panelSet.focus()}),e.exports=x},function(e,t,i){"use strict";e.exports=i(46),e.exports.prototype.name="stb-component-button"},function(e,t,i){"use strict";var n=i(2),a=i(14);function s(e){e=e||{},n.call(this,e),e.icon&&(this.$icon=this.$body.appendChild(document.createElement("div")),this.$icon.className="icon "+e.icon),this.$text=this.$body.appendChild(document.createElement("div")),this.$text.classList.add("text"),e.value&&(this.$text.innerText=e.value)}s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.prototype.name="spa-component-button",s.prototype.clickDuration=200,s.prototype.defaultEvents={click:function(){var e=this;this.$node.classList.add("click"),setTimeout(function(){e.$node.classList.remove("click")},this.clickDuration)},keydown:function(e){e.code===a.enter&&this.events["click"]&&this.emit("click",{event:e})}},e.exports=s},function(e,t,i){"use strict";var n=i(7),a=i(6),s=i(4),o=i(9),c=i(48),l=i(0),r=i(8),d=new n({$node:document.getElementById("pageScanning"),className:"theme-page-background"}),u=document.getElementById("scanningFrequency"),h=0,m=document.getElementById("scanningCount"),p=document.getElementById("scanningChannel"),f=!1;function v(){a.provider.stopScan(),a.route(a.pages.scanOptions)}function g(e){d.progress.set(e.progress),d.progress.$percents.innerText=e.progress+"%",u.innerText=e.frequency}function y(e){h++,m.innerText=h,p.innerText=e.name}function x(){d.progress.set(100),d.progress.$percents.innerText="100%",f=!1,a.route(a.pages.main)}document.getElementById("scanningFrequencyTitle").innerText=gettext("Frequency"),document.getElementById("scanningCountTitle").innerText=gettext("Found in total"),document.getElementById("scanningChannelTitle").innerText=gettext("Last found"),document.getElementById("scanningTitle").innerText=gettext("Finding DVB channels"),d.footer=new r({visible:!0,parent:d,data:[{code:l.f1,title:gettext("Stop scanning"),action:v},{code:l.menu,action:function(){d.modalActions.show()}}]}),d.progress=new c({$node:document.getElementById("scanningProgress"),value:0,className:"theme-progressbar"}),d.progress.$percents=document.getElementById("scanningProgressValue"),d.modalActions=new o({visible:!1,title:gettext("actions"),events:{show:function(){this.focus()}},children:[new s({cycle:!0,size:1,focusIndex:0,data:[{items:[{className:"theme-icon theme-icon-rc-f1",value:""},{value:gettext("Stop scanning")}],click:function(){v(),d.modalActions.hide()}}],events:{keydown:function(e){s.prototype.defaultEvents.keydown.call(this,e),e.code!==l.back&&e.code!==l.menu||(e.stop=!0,d.modalActions.hide())}}})]}),d.add(d.modalActions),d.addListener("keydown",function(e){switch(e.code){case l.back:e.stop=!0,f?core.notify({title:gettext("Do you want to stop scanning?"),icon:"info",type:"",buttons:[{value:gettext("Cancel"),click:function(){}},{value:gettext("Stop"),click:v}]}):a.route(a.pages.scanOptions)}}),d.addListener("show",function(e){var t=e.data;d.config={type:t.currentType.type,callbacks:{onProgress:g,onFound:y,onEnd:x}},f=!0,a.lastIntent&&a.lastIntent.emit("playback:stop"),h=0,m.innerText="0",p.innerText="",u.innerText="",t.manual?(t.more?(d.config.netId=t.network,d.config.frequency=t.frequency,d.config.modulation=t.modulation,d.config.symRate=t.symbolRate):(d.config.frequency=t.frequencyStart,d.config.frequencyEnd=t.frequencyEnd,d.config.band=t.band),a.provider.startManualScan(d.config)):(t.more&&(d.config.symRate=t.symbolRate,d.config.modulation=t.modulation),a.provider.startAutoScan(d.config))}),e.exports=d},function(e,t,i){"use strict";var n=i(2);function a(e){e=e||{},this.max=100,this.min=0,this.value=0,this.step=1,e.focusable=e.focusable||!1,n.call(this,e),this.$value=this.$body.appendChild(document.createElement("div")),this.$value.className="value",this.init(e)}a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.prototype.name="spa-component-progress-bar",a.prototype.set=function(e){var t=this.value;return this.value!==e&&e<=this.max&&e>=this.min&&(this.value=e,100===(e=Math.abs(this.value-this.min)/this.step)&&this.events["done"]&&this.emit("done"),this.$value.style.width=e+"%",this.events["change"]&&this.emit("change",{curr:this.value,prev:t}),!0)},a.prototype.init=function(e){void 0!==e.max&&(this.max=e.max),void 0!==e.min&&(this.min=e.min),void 0!==e.value&&(this.value=e.value),this.step=Math.abs(this.max-this.min)/100,this.$value.style.width=Math.abs(this.min-this.value)/this.step+"%"},e.exports=a}]);
//# sourceMappingURL=main.js.map